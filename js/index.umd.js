(function(Se,Z){typeof exports=="object"&&typeof module<"u"?Z(exports):typeof define=="function"&&define.amd?define(["exports"],Z):(Se=typeof globalThis<"u"?globalThis:Se||self,Z(Se["@walletconnect/sign-client"]={}))})(this,function(Se){"use strict";var Z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function _i(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}function cc(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var uc=fc;function fc(t,e,r){var i=r&&r.stringify||cc,n=1;if(typeof t=="object"&&t!==null){var s=e.length+n;if(s===1)return t;var c=new Array(s);c[0]=i(t);for(var u=1;u<s;u++)c[u]=i(e[u]);return c.join(" ")}if(typeof t!="string")return t;var f=e.length;if(f===0)return t;for(var h="",p=1-n,w=-1,N=t&&t.length||0,m=0;m<N;){if(t.charCodeAt(m)===37&&m+1<N){switch(w=w>-1?w:0,t.charCodeAt(m+1)){case 100:case 102:if(p>=f||e[p]==null)break;w<m&&(h+=t.slice(w,m)),h+=Number(e[p]),w=m+2,m++;break;case 105:if(p>=f||e[p]==null)break;w<m&&(h+=t.slice(w,m)),h+=Math.floor(Number(e[p])),w=m+2,m++;break;case 79:case 111:case 106:if(p>=f||e[p]===void 0)break;w<m&&(h+=t.slice(w,m));var E=typeof e[p];if(E==="string"){h+="'"+e[p]+"'",w=m+2,m++;break}if(E==="function"){h+=e[p].name||"<anonymous>",w=m+2,m++;break}h+=i(e[p]),w=m+2,m++;break;case 115:if(p>=f)break;w<m&&(h+=t.slice(w,m)),h+=String(e[p]),w=m+2,m++;break;case 37:w<m&&(h+=t.slice(w,m)),h+="%",w=m+2,m++,p--;break}++p}++m}return w===-1?t:(w<N&&(h+=t.slice(w)),h)}var In=uc,bi=xt,lr=bc().console||{},hc={mapHttpRequest:Ur,mapHttpResponse:Ur,wrapRequestSerializer:mi,wrapResponseSerializer:mi,wrapErrorSerializer:mi,req:Ur,res:Ur,err:gc};function xt(t){t=t||{},t.browser=t.browser||{};var e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");var r=t.browser.write||lr;t.browser.write&&(t.browser.asObject=!0);var i=t.serializers||{},n=Array.isArray(t.browser.serialize)?t.browser.serialize.filter(function(E){return E!=="!stdSerializers.err"}):t.browser.serialize===!0?Object.keys(i):!1,s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);var c=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");var u=t.level||"info",f=Object.create(r);f.log||(f.log=dr),Object.defineProperty(f,"levelVal",{get:p}),Object.defineProperty(f,"level",{get:w,set:N});var h={transmit:e,serialize:n,asObject:t.browser.asObject,levels:c,timestamp:yc(t)};f.levels=xt.levels,f.level=u,f.setMaxListeners=f.getMaxListeners=f.emit=f.addListener=f.on=f.prependListener=f.once=f.prependOnceListener=f.removeListener=f.removeAllListeners=f.listeners=f.listenerCount=f.eventNames=f.write=f.flush=dr,f.serializers=i,f._serialize=n,f._stdErrSerialize=s,f.child=m,e&&(f._logEvent=wi());function p(){return this.level==="silent"?1/0:this.levels.values[this.level]}function w(){return this._level}function N(E){if(E!=="silent"&&!this.levels.values[E])throw Error("unknown level "+E);this._level=E,Zt(h,f,"error","log"),Zt(h,f,"fatal","error"),Zt(h,f,"warn","error"),Zt(h,f,"info","log"),Zt(h,f,"debug","log"),Zt(h,f,"trace","log")}function m(E){if(!E)throw new Error("missing bindings for child Pino");var L=E.serializers;if(n&&L){var C=Object.assign({},i,L),M=t.browser.serialize===!0?Object.keys(C):n;delete E.serializers,Fr([E],M,C,this._stdErrSerialize)}function b(x){this._childLevel=(x._childLevel|0)+1,this.error=Qt(x,E,"error"),this.fatal=Qt(x,E,"fatal"),this.warn=Qt(x,E,"warn"),this.info=Qt(x,E,"info"),this.debug=Qt(x,E,"debug"),this.trace=Qt(x,E,"trace"),C&&(this.serializers=C,this._serialize=M),e&&(this._logEvent=wi([].concat(x._logEvent.bindings,E)))}return b.prototype=this,new b(this)}return f}xt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},xt.stdSerializers=hc,xt.stdTimeFunctions=Object.assign({},{nullTime:An,epochTime:Nn,unixTime:vc,isoTime:_c});function Zt(t,e,r,i){var n=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?dr:n[r]?n[r]:lr[r]||lr[i]||dr,lc(t,e,r)}function lc(t,e,r){!t.transmit&&e[r]===dr||(e[r]=function(i){return function(){for(var s=t.timestamp(),c=new Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===lr?lr:this,f=0;f<c.length;f++)c[f]=arguments[f];if(t.serialize&&!t.asObject&&Fr(c,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?i.call(u,dc(this,r,c,s)):i.apply(u,c),t.transmit){var h=t.transmit.level||e.level,p=xt.levels.values[h],w=xt.levels.values[r];if(w<p)return;pc(this,{ts:s,methodLevel:r,methodValue:w,transmitLevel:h,transmitValue:xt.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},c)}}}(e[r]))}function dc(t,e,r,i){t._serialize&&Fr(r,t._serialize,t.serializers,t._stdErrSerialize);var n=r.slice(),s=n[0],c={};i&&(c.time=i),c.level=xt.levels.values[e];var u=(t._childLevel|0)+1;if(u<1&&(u=1),s!==null&&typeof s=="object"){for(;u--&&typeof n[0]=="object";)Object.assign(c,n.shift());s=n.length?In(n.shift(),n):void 0}else typeof s=="string"&&(s=In(n.shift(),n));return s!==void 0&&(c.msg=s),c}function Fr(t,e,r,i){for(var n in t)if(i&&t[n]instanceof Error)t[n]=xt.stdSerializers.err(t[n]);else if(typeof t[n]=="object"&&!Array.isArray(t[n]))for(var s in t[n])e&&e.indexOf(s)>-1&&s in r&&(t[n][s]=r[s](t[n][s]))}function Qt(t,e,r){return function(){var i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return t[r].apply(this,i)}}function pc(t,e,r){var i=e.send,n=e.ts,s=e.methodLevel,c=e.methodValue,u=e.val,f=t._logEvent.bindings;Fr(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=n,t._logEvent.messages=r.filter(function(h){return f.indexOf(h)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=c,i(s,t._logEvent,u),t._logEvent=wi(f)}function wi(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function gc(t){var e={type:t.constructor.name,msg:t.message,stack:t.stack};for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}function yc(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?An:Nn}function Ur(){return{}}function mi(t){return t}function dr(){}function An(){return!1}function Nn(){return Date.now()}function vc(){return Math.round(Date.now()/1e3)}function _c(){return new Date(Date.now()).toISOString()}function bc(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var Mr={},Ei=function(t,e){return Ei=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])},Ei(t,e)};function wc(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ei(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Di=function(){return Di=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Di.apply(this,arguments)};function mc(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Ec(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(n<3?c(s):n>3?c(e,r,s):c(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Dc(t,e){return function(r,i){e(r,i,t)}}function Sc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function xc(t,e,r,i){function n(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(p){try{h(i.next(p))}catch(w){c(w)}}function f(p){try{h(i.throw(p))}catch(w){c(w)}}function h(p){p.done?s(p.value):n(p.value).then(u,f)}h((i=i.apply(t,e||[])).next())})}function Oc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(h){return function(p){return f([h,p])}}function f(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(p){h=[6,p],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}var Si=Object.create?function(t,e,r,i){i===void 0&&(i=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,i,n)}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]};function Ic(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Si(e,t,r)}function xi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Tn(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],c;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){c={error:u}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(c)throw c.error}}return s}function Ac(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Tn(arguments[e]));return t}function Nc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,n++)i[n]=s[c];return i}function Tc(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}function pr(t){return this instanceof pr?(this.v=t,this):new pr(t)}function Cc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},c("next"),c("throw"),c("return"),n[Symbol.asyncIterator]=function(){return this},n;function c(N){i[N]&&(n[N]=function(m){return new Promise(function(E,L){s.push([N,m,E,L])>1||u(N,m)})})}function u(N,m){try{f(i[N](m))}catch(E){w(s[0][3],E)}}function f(N){N.value instanceof pr?Promise.resolve(N.value.v).then(h,p):w(s[0][2],N)}function h(N){u("next",N)}function p(N){u("throw",N)}function w(N,m){N(m),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Lc(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(c){return(r=!r)?{value:pr(t[n](c)),done:n==="return"}:s?s(c):c}:s}}function Rc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof xi=="function"?xi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(c){return new Promise(function(u,f){c=t[s](c),n(u,f,c.done,c.value)})}}function n(s,c,u,f){Promise.resolve(f).then(function(h){s({value:h,done:u})},c)}}function Pc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var Fc=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function Uc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Si(e,t,r);return Fc(e,t),e}function Mc(t){return t&&t.__esModule?t:{default:t}}function jc(t,e,r,i){if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?i:r==="a"?i.call(t):i?i.value:e.get(t)}function $c(t,e,r,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}function Bc(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}var zc=Object.freeze({__proto__:null,__extends:wc,get __assign(){return Di},__rest:mc,__decorate:Ec,__param:Dc,__metadata:Sc,__awaiter:xc,__generator:Oc,__createBinding:Si,__exportStar:Ic,__values:xi,__read:Tn,__spread:Ac,__spreadArrays:Nc,__spreadArray:Tc,__await:pr,__asyncGenerator:Cc,__asyncDelegator:Lc,__asyncValues:Rc,__makeTemplateObject:Pc,__importStar:Uc,__importDefault:Mc,__classPrivateFieldGet:jc,__classPrivateFieldSet:$c,__classPrivateFieldIn:Bc}),Oi=_i(zc),jr={exports:{}},Cn;function Kc(){return Cn||(Cn=1,function(){var t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){var r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),Z.localStorage?jr.exports=localStorage:jr.exports=new e}()),jr.exports}var gr={},Ln;function Rn(){if(Ln)return gr;Ln=1,Object.defineProperty(gr,"__esModule",{value:!0});function t(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}gr.safeJsonParse=t;function e(r){return typeof r=="string"?r:JSON.stringify(r,(i,n)=>typeof n>"u"?null:n)}return gr.safeJsonStringify=e,gr}var Ii={},yr={},Pn;function Hc(){if(Pn)return yr;Pn=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.IKeyValueStorage=void 0;class t{}return yr.IKeyValueStorage=t,yr}var vr={},Fn;function Vc(){if(Fn)return vr;Fn=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.parseEntry=void 0;const t=Rn();function e(r){var i;return[r[0],t.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return vr.parseEntry=e,vr}var Un;function Gc(){return Un||(Un=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Oi;e.__exportStar(Hc(),t),e.__exportStar(Vc(),t)}(Ii)),Ii}Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.KeyValueStorage=void 0;const er=Oi,qc=er.__importDefault(Kc()),Mn=Rn(),Wc=Gc();class jn{constructor(){this.localStorage=qc.default}getKeys(){return er.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return er.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Wc.parseEntry)})}getItem(e){return er.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return Mn.safeJsonParse(r)})}setItem(e,r){return er.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Mn.safeJsonStringify(r))})}removeItem(e){return er.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Mr.KeyValueStorage=jn;var Yc=Mr.default=jn,_r={},$r={},Nt={exports:{}},tr=typeof Reflect=="object"?Reflect:null,$n=tr&&typeof tr.apply=="function"?tr.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},Br;tr&&typeof tr.ownKeys=="function"?Br=tr.ownKeys:Object.getOwnPropertySymbols?Br=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Br=function(e){return Object.getOwnPropertyNames(e)};function Xc(t){console&&console.warn&&console.warn(t)}var Bn=Number.isNaN||function(e){return e!==e};function xe(){xe.init.call(this)}Nt.exports=xe,Nt.exports.once=Qc,xe.EventEmitter=xe,xe.prototype._events=void 0,xe.prototype._eventsCount=0,xe.prototype._maxListeners=void 0;var zn=10;function zr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(xe,"defaultMaxListeners",{enumerable:!0,get:function(){return zn},set:function(t){if(typeof t!="number"||t<0||Bn(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");zn=t}}),xe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},xe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Bn(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Kn(t){return t._maxListeners===void 0?xe.defaultMaxListeners:t._maxListeners}xe.prototype.getMaxListeners=function(){return Kn(this)},xe.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var c;if(r.length>0&&(c=r[0]),c instanceof Error)throw c;var u=new Error("Unhandled error."+(c?" ("+c.message+")":""));throw u.context=c,u}var f=s[e];if(f===void 0)return!1;if(typeof f=="function")$n(f,this,r);else for(var h=f.length,p=Wn(f,h),i=0;i<h;++i)$n(p[i],this,r);return!0};function Hn(t,e,r,i){var n,s,c;if(zr(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),c=s[e]),c===void 0)c=s[e]=r,++t._eventsCount;else if(typeof c=="function"?c=s[e]=i?[r,c]:[c,r]:i?c.unshift(r):c.push(r),n=Kn(t),n>0&&c.length>n&&!c.warned){c.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=c.length,Xc(u)}return t}xe.prototype.addListener=function(e,r){return Hn(this,e,r,!1)},xe.prototype.on=xe.prototype.addListener,xe.prototype.prependListener=function(e,r){return Hn(this,e,r,!0)};function Jc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Vn(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=Jc.bind(i);return n.listener=r,i.wrapFn=n,n}xe.prototype.once=function(e,r){return zr(r),this.on(e,Vn(this,e,r)),this},xe.prototype.prependOnceListener=function(e,r){return zr(r),this.prependListener(e,Vn(this,e,r)),this},xe.prototype.removeListener=function(e,r){var i,n,s,c,u;if(zr(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,c=i.length-1;c>=0;c--)if(i[c]===r||i[c].listener===r){u=i[c].listener,s=c;break}if(s<0)return this;s===0?i.shift():kc(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,u||r)}return this},xe.prototype.off=xe.prototype.removeListener,xe.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),c;for(n=0;n<s.length;++n)c=s[n],c!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function Gn(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?Zc(n):Wn(n,n.length)}xe.prototype.listeners=function(e){return Gn(this,e,!0)},xe.prototype.rawListeners=function(e){return Gn(this,e,!1)},xe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):qn.call(t,e)},xe.prototype.listenerCount=qn;function qn(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}xe.prototype.eventNames=function(){return this._eventsCount>0?Br(this._events):[]};function Wn(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function kc(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Zc(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Qc(t,e){return new Promise(function(r,i){function n(c){t.removeListener(e,s),i(c)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}Yn(t,e,s,{once:!0}),e!=="error"&&eu(t,n,{once:!0})})}function eu(t,e,r){typeof t.on=="function"&&Yn(t,"error",e,r)}function Yn(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Te={},Xn={},Kr={};Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.delay=void 0;function tu(t){return new Promise(e=>{setTimeout(()=>{e(!0)},t)})}Kr.delay=tu;var rr={},Ai={},ir={};Object.defineProperty(ir,"__esModule",{value:!0}),ir.ONE_THOUSAND=ir.ONE_HUNDRED=void 0,ir.ONE_HUNDRED=100,ir.ONE_THOUSAND=1e3;var Jn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365})(Jn),function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,c){c===void 0&&(c=s),Object.defineProperty(i,c,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,c){c===void 0&&(c=s),i[c]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(ir,t),r(Jn,t)}(Ai),Object.defineProperty(rr,"__esModule",{value:!0}),rr.fromMiliseconds=rr.toMiliseconds=void 0;const kn=Ai;function ru(t){return t*kn.ONE_THOUSAND}rr.toMiliseconds=ru;function iu(t){return Math.floor(t/kn.ONE_THOUSAND)}rr.fromMiliseconds=iu,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,c){c===void 0&&(c=s),Object.defineProperty(i,c,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,c){c===void 0&&(c=s),i[c]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(Kr,t),r(rr,t)}(Xn);var br={};Object.defineProperty(br,"__esModule",{value:!0}),br.Watch=void 0;class Zn{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw new Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){const r=this.get(e);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${e}`);const i=Date.now()-r.started;this.timestamps.set(e,{started:r.started,elapsed:i})}get(e){const r=this.timestamps.get(e);if(typeof r>"u")throw new Error(`No timestamp found for label: ${e}`);return r}elapsed(e){const r=this.get(e);return r.elapsed||Date.now()-r.started}}br.Watch=Zn,br.default=Zn;var Qn={},Hr={};Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.IWatch=void 0;class nu{}Hr.IWatch=nu,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,c){c===void 0&&(c=s),Object.defineProperty(i,c,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,c){c===void 0&&(c=s),i[c]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(Hr,t)}(Qn),function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,c){c===void 0&&(c=s),Object.defineProperty(i,c,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,c){c===void 0&&(c=s),i[c]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(Xn,t),r(br,t),r(Qn,t),r(Ai,t)}(Te);var Ni={},Vr={};class Kt{}var su=Object.freeze({__proto__:null,IEvents:Kt}),ou=_i(su);Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.IHeartBeat=void 0;const au=ou;class cu extends au.IEvents{constructor(e){super()}}Vr.IHeartBeat=cu,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,c){c===void 0&&(c=s),Object.defineProperty(i,c,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,c){c===void 0&&(c=s),i[c]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(Vr,t)}(Ni);var Ti={},nr={};Object.defineProperty(nr,"__esModule",{value:!0}),nr.HEARTBEAT_EVENTS=nr.HEARTBEAT_INTERVAL=void 0;const uu=Te;nr.HEARTBEAT_INTERVAL=uu.FIVE_SECONDS,nr.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,c){c===void 0&&(c=s),Object.defineProperty(i,c,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,c){c===void 0&&(c=s),i[c]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(nr,t)}(Ti);var Ci=Z&&Z.__awaiter||function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(p){try{h(i.next(p))}catch(w){c(w)}}function f(p){try{h(i.throw(p))}catch(w){c(w)}}function h(p){p.done?s(p.value):n(p.value).then(u,f)}h((i=i.apply(t,e||[])).next())})};Object.defineProperty($r,"__esModule",{value:!0}),$r.HeartBeat=void 0;const fu=Nt.exports,hu=Te,lu=Ni,Li=Ti;class Ri extends lu.IHeartBeat{constructor(e){super(e),this.events=new fu.EventEmitter,this.interval=Li.HEARTBEAT_INTERVAL,this.interval=e?.interval||Li.HEARTBEAT_INTERVAL}static init(e){return Ci(this,void 0,void 0,function*(){const r=new Ri(e);return yield r.init(),r})}init(){return Ci(this,void 0,void 0,function*(){yield this.initialize()})}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}initialize(){return Ci(this,void 0,void 0,function*(){setInterval(()=>this.pulse(),hu.toMiliseconds(this.interval))})}pulse(){this.events.emit(Li.HEARTBEAT_EVENTS.pulse)}}$r.HeartBeat=Ri,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,c){c===void 0&&(c=s),Object.defineProperty(i,c,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,c){c===void 0&&(c=s),i[c]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r($r,t),r(Ni,t),r(Ti,t)}(_r);var Ae={},Ht={},es;function ts(){return es||(es=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.PINO_CUSTOM_CONTEXT_KEY=Ht.PINO_LOGGER_DEFAULTS=void 0,Ht.PINO_LOGGER_DEFAULTS={level:"info"},Ht.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Ht}var at={},rs;function du(){if(rs)return at;rs=1,Object.defineProperty(at,"__esModule",{value:!0}),at.generateChildLogger=at.formatChildLoggerContext=at.getLoggerContext=at.setBrowserLoggerContext=at.getBrowserLoggerContext=at.getDefaultLoggerOptions=void 0;const t=ts();function e(u){return Object.assign(Object.assign({},u),{level:u?.level||t.PINO_LOGGER_DEFAULTS.level})}at.getDefaultLoggerOptions=e;function r(u,f=t.PINO_CUSTOM_CONTEXT_KEY){return u[f]||""}at.getBrowserLoggerContext=r;function i(u,f,h=t.PINO_CUSTOM_CONTEXT_KEY){return u[h]=f,u}at.setBrowserLoggerContext=i;function n(u,f=t.PINO_CUSTOM_CONTEXT_KEY){let h="";return typeof u.bindings>"u"?h=r(u,f):h=u.bindings().context||"",h}at.getLoggerContext=n;function s(u,f,h=t.PINO_CUSTOM_CONTEXT_KEY){const p=n(u,h);return p.trim()?`${p}/${f}`:f}at.formatChildLoggerContext=s;function c(u,f,h=t.PINO_CUSTOM_CONTEXT_KEY){const p=s(u,f,h),w=u.child({context:p});return i(w,p,h)}return at.generateChildLogger=c,at}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Oi;e.__exportStar(ts(),t),e.__exportStar(du(),t)})(Ae);class pu extends Kt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class gu extends Kt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class yu{constructor(e,r){this.logger=e,this.core=r}}class vu extends Kt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class _u extends Kt{constructor(e){super()}}class bu{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}}class wu extends Kt{constructor(e,r){super(),this.relayer=e,this.logger=r}}var Pi={exports:{}},sr=typeof Reflect=="object"?Reflect:null,is=sr&&typeof sr.apply=="function"?sr.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)},Gr;sr&&typeof sr.ownKeys=="function"?Gr=sr.ownKeys:Object.getOwnPropertySymbols?Gr=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Gr=function(t){return Object.getOwnPropertyNames(t)};function mu(t){console&&console.warn&&console.warn(t)}var ns=Number.isNaN||function(t){return t!==t};function Oe(){Oe.init.call(this)}Pi.exports=Oe,Pi.exports.once=xu,Oe.EventEmitter=Oe,Oe.prototype._events=void 0,Oe.prototype._eventsCount=0,Oe.prototype._maxListeners=void 0;var ss=10;function qr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return ss},set:function(t){if(typeof t!="number"||t<0||ns(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ss=t}}),Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Oe.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||ns(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function os(t){return t._maxListeners===void 0?Oe.defaultMaxListeners:t._maxListeners}Oe.prototype.getMaxListeners=function(){return os(this)},Oe.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var i=t==="error",n=this._events;if(n!==void 0)i=i&&n.error===void 0;else if(!i)return!1;if(i){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var c=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw c.context=s,c}var u=n[t];if(u===void 0)return!1;if(typeof u=="function")is(u,this,e);else for(var f=u.length,h=hs(u,f),r=0;r<f;++r)is(h[r],this,e);return!0};function as(t,e,r,i){var n,s,c;if(qr(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),c=s[e]),c===void 0)c=s[e]=r,++t._eventsCount;else if(typeof c=="function"?c=s[e]=i?[r,c]:[c,r]:i?c.unshift(r):c.push(r),n=os(t),n>0&&c.length>n&&!c.warned){c.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=c.length,mu(u)}return t}Oe.prototype.addListener=function(t,e){return as(this,t,e,!1)},Oe.prototype.on=Oe.prototype.addListener,Oe.prototype.prependListener=function(t,e){return as(this,t,e,!0)};function Eu(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function cs(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=Eu.bind(i);return n.listener=r,i.wrapFn=n,n}Oe.prototype.once=function(t,e){return qr(e),this.on(t,cs(this,t,e)),this},Oe.prototype.prependOnceListener=function(t,e){return qr(e),this.prependListener(t,cs(this,t,e)),this},Oe.prototype.removeListener=function(t,e){var r,i,n,s,c;if(qr(e),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===e||r.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if(typeof r!="function"){for(n=-1,s=r.length-1;s>=0;s--)if(r[s]===e||r[s].listener===e){c=r[s].listener,n=s;break}if(n<0)return this;n===0?r.shift():Du(r,n),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,c||e)}return this},Oe.prototype.off=Oe.prototype.removeListener,Oe.prototype.removeAllListeners=function(t){var e,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var n=Object.keys(r),s;for(i=0;i<n.length;++i)s=n[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=r[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this};function us(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?Su(n):hs(n,n.length)}Oe.prototype.listeners=function(t){return us(this,t,!0)},Oe.prototype.rawListeners=function(t){return us(this,t,!1)},Oe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):fs.call(t,e)},Oe.prototype.listenerCount=fs;function fs(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?Gr(this._events):[]};function hs(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function Du(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Su(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function xu(t,e){return new Promise(function(r,i){function n(c){t.removeListener(e,s),i(c)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}ls(t,e,s,{once:!0}),e!=="error"&&Ou(t,n,{once:!0})})}function Ou(t,e,r){typeof t.on=="function"&&ls(t,"error",e,r)}function ls(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}class Iu{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class C1 extends Pi.exports.EventEmitter{constructor(){super()}}class Au{constructor(e){this.client=e}}class Nu extends Kt{constructor(e,r){super(),this.core=e,this.logger=r}}function ds(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function Fi(t){return typeof t=="string"?t:JSON.stringify(t)}var Ui={},ps={},Wr={},Yr={};Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.BrowserRandomSource=void 0;const gs=65536;class Tu{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let i=0;i<r.length;i+=gs)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,gs)));return r}}Yr.BrowserRandomSource=Tu;function ys(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Xr={},ct={};Object.defineProperty(ct,"__esModule",{value:!0});function Cu(t){for(var e=0;e<t.length;e++)t[e]=0;return t}ct.wipe=Cu;var Lu={},Ru=Object.freeze({__proto__:null,default:Lu}),vs=_i(Ru);Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.NodeRandomSource=void 0;const Pu=ct;class Fu{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof ys<"u"){const e=vs;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=r[n];return(0,Pu.wipe)(r),i}}Xr.NodeRandomSource=Fu,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.SystemRandomSource=void 0;const Uu=Yr,Mu=Xr;class ju{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Uu.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Mu.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Wr.SystemRandomSource=ju;var ee={},_s={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(u,f){var h=u>>>16&65535,p=u&65535,w=f>>>16&65535,N=f&65535;return p*N+(h*N+p*w<<16>>>0)|0}t.mul=Math.imul||e;function r(u,f){return u+f|0}t.add=r;function i(u,f){return u-f|0}t.sub=i;function n(u,f){return u<<f|u>>>32-f}t.rotl=n;function s(u,f){return u<<32-f|u>>>f}t.rotr=s;function c(u){return typeof u=="number"&&isFinite(u)&&Math.floor(u)===u}t.isInteger=Number.isInteger||c,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(u){return t.isInteger(u)&&u>=-t.MAX_SAFE_INTEGER&&u<=t.MAX_SAFE_INTEGER}})(_s),Object.defineProperty(ee,"__esModule",{value:!0});var bs=_s;function $u(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}ee.readInt16BE=$u;function Bu(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}ee.readUint16BE=Bu;function zu(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}ee.readInt16LE=zu;function Ku(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}ee.readUint16LE=Ku;function ws(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}ee.writeUint16BE=ws,ee.writeInt16BE=ws;function ms(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}ee.writeUint16LE=ms,ee.writeInt16LE=ms;function Mi(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}ee.readInt32BE=Mi;function ji(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}ee.readUint32BE=ji;function $i(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}ee.readInt32LE=$i;function Bi(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}ee.readUint32LE=Bi;function Jr(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}ee.writeUint32BE=Jr,ee.writeInt32BE=Jr;function kr(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}ee.writeUint32LE=kr,ee.writeInt32LE=kr;function Hu(t,e){e===void 0&&(e=0);var r=Mi(t,e),i=Mi(t,e+4);return r*4294967296+i-(i>>31)*4294967296}ee.readInt64BE=Hu;function Vu(t,e){e===void 0&&(e=0);var r=ji(t,e),i=ji(t,e+4);return r*4294967296+i}ee.readUint64BE=Vu;function Gu(t,e){e===void 0&&(e=0);var r=$i(t,e),i=$i(t,e+4);return i*4294967296+r-(r>>31)*4294967296}ee.readInt64LE=Gu;function qu(t,e){e===void 0&&(e=0);var r=Bi(t,e),i=Bi(t,e+4);return i*4294967296+r}ee.readUint64LE=qu;function Es(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Jr(t/4294967296>>>0,e,r),Jr(t>>>0,e,r+4),e}ee.writeUint64BE=Es,ee.writeInt64BE=Es;function Ds(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),kr(t>>>0,e,r),kr(t/4294967296>>>0,e,r+4),e}ee.writeUint64LE=Ds,ee.writeInt64LE=Ds;function Wu(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}ee.readUintBE=Wu;function Yu(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}ee.readUintLE=Yu;function Xu(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!bs.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}ee.writeUintBE=Xu;function Ju(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!bs.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}ee.writeUintLE=Ju;function ku(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}ee.readFloat32BE=ku;function Zu(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}ee.readFloat32LE=Zu;function Qu(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}ee.readFloat64BE=Qu;function ef(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}ee.readFloat64LE=ef;function tf(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}ee.writeFloat32BE=tf;function rf(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}ee.writeFloat32LE=rf;function nf(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}ee.writeFloat64BE=nf;function sf(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}ee.writeFloat64LE=sf,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=Wr,r=ee,i=ct;t.defaultRandomSource=new e.SystemRandomSource;function n(h,p=t.defaultRandomSource){return p.randomBytes(h)}t.randomBytes=n;function s(h=t.defaultRandomSource){const p=n(4,h),w=(0,r.readUint32LE)(p);return(0,i.wipe)(p),w}t.randomUint32=s;const c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(h,p=c,w=t.defaultRandomSource){if(p.length<2)throw new Error("randomString charset is too short");if(p.length>256)throw new Error("randomString charset is too long");let N="";const m=p.length,E=256-256%m;for(;h>0;){const L=n(Math.ceil(h*256/E),w);for(let C=0;C<L.length&&h>0;C++){const M=L[C];M<E&&(N+=p.charAt(M%m),h--)}(0,i.wipe)(L)}return N}t.randomString=u;function f(h,p=c,w=t.defaultRandomSource){const N=Math.ceil(h/(Math.log(p.length)/Math.LN2));return u(N,p,w)}t.randomStringForEntropy=f}(ps);var Ss={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ee,r=ct;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},u.prototype.update=function(f,h){if(h===void 0&&(h=f.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var p=0;if(this._bytesHashed+=h,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&h>0;)this._buffer[this._bufferLength++]=f[p++],h--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(h>=this.blockSize&&(p=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,f,p,h),h%=this.blockSize);h>0;)this._buffer[this._bufferLength++]=f[p++],h--;return this},u.prototype.finish=function(f){if(!this._finished){var h=this._bytesHashed,p=this._bufferLength,w=h/536870912|0,N=h<<3,m=h%128<112?128:256;this._buffer[p]=128;for(var E=p+1;E<m-8;E++)this._buffer[E]=0;e.writeUint32BE(w,this._buffer,m-8),e.writeUint32BE(N,this._buffer,m-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,m),this._finished=!0}for(var E=0;E<this.digestLength/8;E++)e.writeUint32BE(this._stateHi[E],f,E*8),e.writeUint32BE(this._stateLo[E],f,E*8+4);return this},u.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(f){return this._stateHi.set(f.stateHi),this._stateLo.set(f.stateLo),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(f){r.wipe(f.stateHi),r.wipe(f.stateLo),f.buffer&&r.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},u}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(u,f,h,p,w,N,m){for(var E=h[0],L=h[1],C=h[2],M=h[3],b=h[4],x=h[5],g=h[6],_=h[7],v=p[0],o=p[1],d=p[2],F=p[3],K=p[4],X=p[5],J=p[6],k=p[7],O,T,G,W,P,U,j,$;m>=128;){for(var ie=0;ie<16;ie++){var B=8*ie+N;u[ie]=e.readUint32BE(w,B),f[ie]=e.readUint32BE(w,B+4)}for(var ie=0;ie<80;ie++){var Q=E,Y=L,ae=C,A=M,I=b,D=x,a=g,y=_,z=v,H=o,he=d,ve=F,de=K,we=X,$e=J,Pe=k;if(O=_,T=k,P=T&65535,U=T>>>16,j=O&65535,$=O>>>16,O=(b>>>14|K<<32-14)^(b>>>18|K<<32-18)^(K>>>41-32|b<<32-(41-32)),T=(K>>>14|b<<32-14)^(K>>>18|b<<32-18)^(b>>>41-32|K<<32-(41-32)),P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,O=b&x^~b&g,T=K&X^~K&J,P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,O=n[ie*2],T=n[ie*2+1],P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,O=u[ie%16],T=f[ie%16],P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,U+=P>>>16,j+=U>>>16,$+=j>>>16,G=j&65535|$<<16,W=P&65535|U<<16,O=G,T=W,P=T&65535,U=T>>>16,j=O&65535,$=O>>>16,O=(E>>>28|v<<32-28)^(v>>>34-32|E<<32-(34-32))^(v>>>39-32|E<<32-(39-32)),T=(v>>>28|E<<32-28)^(E>>>34-32|v<<32-(34-32))^(E>>>39-32|v<<32-(39-32)),P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,O=E&L^E&C^L&C,T=v&o^v&d^o&d,P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,U+=P>>>16,j+=U>>>16,$+=j>>>16,y=j&65535|$<<16,Pe=P&65535|U<<16,O=A,T=ve,P=T&65535,U=T>>>16,j=O&65535,$=O>>>16,O=G,T=W,P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,U+=P>>>16,j+=U>>>16,$+=j>>>16,A=j&65535|$<<16,ve=P&65535|U<<16,L=Q,C=Y,M=ae,b=A,x=I,g=D,_=a,E=y,o=z,d=H,F=he,K=ve,X=de,J=we,k=$e,v=Pe,ie%16===15)for(var B=0;B<16;B++)O=u[B],T=f[B],P=T&65535,U=T>>>16,j=O&65535,$=O>>>16,O=u[(B+9)%16],T=f[(B+9)%16],P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,G=u[(B+1)%16],W=f[(B+1)%16],O=(G>>>1|W<<32-1)^(G>>>8|W<<32-8)^G>>>7,T=(W>>>1|G<<32-1)^(W>>>8|G<<32-8)^(W>>>7|G<<32-7),P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,G=u[(B+14)%16],W=f[(B+14)%16],O=(G>>>19|W<<32-19)^(W>>>61-32|G<<32-(61-32))^G>>>6,T=(W>>>19|G<<32-19)^(G>>>61-32|W<<32-(61-32))^(W>>>6|G<<32-6),P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,U+=P>>>16,j+=U>>>16,$+=j>>>16,u[B]=j&65535|$<<16,f[B]=P&65535|U<<16}O=E,T=v,P=T&65535,U=T>>>16,j=O&65535,$=O>>>16,O=h[0],T=p[0],P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,U+=P>>>16,j+=U>>>16,$+=j>>>16,h[0]=E=j&65535|$<<16,p[0]=v=P&65535|U<<16,O=L,T=o,P=T&65535,U=T>>>16,j=O&65535,$=O>>>16,O=h[1],T=p[1],P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,U+=P>>>16,j+=U>>>16,$+=j>>>16,h[1]=L=j&65535|$<<16,p[1]=o=P&65535|U<<16,O=C,T=d,P=T&65535,U=T>>>16,j=O&65535,$=O>>>16,O=h[2],T=p[2],P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,U+=P>>>16,j+=U>>>16,$+=j>>>16,h[2]=C=j&65535|$<<16,p[2]=d=P&65535|U<<16,O=M,T=F,P=T&65535,U=T>>>16,j=O&65535,$=O>>>16,O=h[3],T=p[3],P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,U+=P>>>16,j+=U>>>16,$+=j>>>16,h[3]=M=j&65535|$<<16,p[3]=F=P&65535|U<<16,O=b,T=K,P=T&65535,U=T>>>16,j=O&65535,$=O>>>16,O=h[4],T=p[4],P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,U+=P>>>16,j+=U>>>16,$+=j>>>16,h[4]=b=j&65535|$<<16,p[4]=K=P&65535|U<<16,O=x,T=X,P=T&65535,U=T>>>16,j=O&65535,$=O>>>16,O=h[5],T=p[5],P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,U+=P>>>16,j+=U>>>16,$+=j>>>16,h[5]=x=j&65535|$<<16,p[5]=X=P&65535|U<<16,O=g,T=J,P=T&65535,U=T>>>16,j=O&65535,$=O>>>16,O=h[6],T=p[6],P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,U+=P>>>16,j+=U>>>16,$+=j>>>16,h[6]=g=j&65535|$<<16,p[6]=J=P&65535|U<<16,O=_,T=k,P=T&65535,U=T>>>16,j=O&65535,$=O>>>16,O=h[7],T=p[7],P+=T&65535,U+=T>>>16,j+=O&65535,$+=O>>>16,U+=P>>>16,j+=U>>>16,$+=j>>>16,h[7]=_=j&65535|$<<16,p[7]=k=P&65535|U<<16,N+=128,m-=128}return N}function c(u){var f=new i;f.update(u);var h=f.digest();return f.clean(),h}t.hash=c})(Ss),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=ps,r=Ss,i=ct;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(A){const I=new Float64Array(16);if(A)for(let D=0;D<A.length;D++)I[D]=A[D];return I}const s=new Uint8Array(32);s[0]=9;const c=n(),u=n([1]),f=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),p=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),w=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),N=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function m(A,I){for(let D=0;D<16;D++)A[D]=I[D]|0}function E(A){let I=1;for(let D=0;D<16;D++){let a=A[D]+I+65535;I=Math.floor(a/65536),A[D]=a-I*65536}A[0]+=I-1+37*(I-1)}function L(A,I,D){const a=~(D-1);for(let y=0;y<16;y++){const z=a&(A[y]^I[y]);A[y]^=z,I[y]^=z}}function C(A,I){const D=n(),a=n();for(let y=0;y<16;y++)a[y]=I[y];E(a),E(a),E(a);for(let y=0;y<2;y++){D[0]=a[0]-65517;for(let H=1;H<15;H++)D[H]=a[H]-65535-(D[H-1]>>16&1),D[H-1]&=65535;D[15]=a[15]-32767-(D[14]>>16&1);const z=D[15]>>16&1;D[14]&=65535,L(a,D,1-z)}for(let y=0;y<16;y++)A[2*y]=a[y]&255,A[2*y+1]=a[y]>>8}function M(A,I){let D=0;for(let a=0;a<32;a++)D|=A[a]^I[a];return(1&D-1>>>8)-1}function b(A,I){const D=new Uint8Array(32),a=new Uint8Array(32);return C(D,A),C(a,I),M(D,a)}function x(A){const I=new Uint8Array(32);return C(I,A),I[0]&1}function g(A,I){for(let D=0;D<16;D++)A[D]=I[2*D]+(I[2*D+1]<<8);A[15]&=32767}function _(A,I,D){for(let a=0;a<16;a++)A[a]=I[a]+D[a]}function v(A,I,D){for(let a=0;a<16;a++)A[a]=I[a]-D[a]}function o(A,I,D){let a,y,z=0,H=0,he=0,ve=0,de=0,we=0,$e=0,Pe=0,ye=0,pe=0,le=0,ue=0,ce=0,oe=0,se=0,te=0,fe=0,ge=0,re=0,_e=0,be=0,Ee=0,De=0,me=0,Dt=0,At=0,jt=0,pt=0,Yt=0,Lr=0,hi=0,Be=D[0],Fe=D[1],ze=D[2],Ke=D[3],He=D[4],Ue=D[5],qe=D[6],We=D[7],Ye=D[8],Xe=D[9],Je=D[10],Ge=D[11],Ve=D[12],Le=D[13],ke=D[14],Ze=D[15];a=I[0],z+=a*Be,H+=a*Fe,he+=a*ze,ve+=a*Ke,de+=a*He,we+=a*Ue,$e+=a*qe,Pe+=a*We,ye+=a*Ye,pe+=a*Xe,le+=a*Je,ue+=a*Ge,ce+=a*Ve,oe+=a*Le,se+=a*ke,te+=a*Ze,a=I[1],H+=a*Be,he+=a*Fe,ve+=a*ze,de+=a*Ke,we+=a*He,$e+=a*Ue,Pe+=a*qe,ye+=a*We,pe+=a*Ye,le+=a*Xe,ue+=a*Je,ce+=a*Ge,oe+=a*Ve,se+=a*Le,te+=a*ke,fe+=a*Ze,a=I[2],he+=a*Be,ve+=a*Fe,de+=a*ze,we+=a*Ke,$e+=a*He,Pe+=a*Ue,ye+=a*qe,pe+=a*We,le+=a*Ye,ue+=a*Xe,ce+=a*Je,oe+=a*Ge,se+=a*Ve,te+=a*Le,fe+=a*ke,ge+=a*Ze,a=I[3],ve+=a*Be,de+=a*Fe,we+=a*ze,$e+=a*Ke,Pe+=a*He,ye+=a*Ue,pe+=a*qe,le+=a*We,ue+=a*Ye,ce+=a*Xe,oe+=a*Je,se+=a*Ge,te+=a*Ve,fe+=a*Le,ge+=a*ke,re+=a*Ze,a=I[4],de+=a*Be,we+=a*Fe,$e+=a*ze,Pe+=a*Ke,ye+=a*He,pe+=a*Ue,le+=a*qe,ue+=a*We,ce+=a*Ye,oe+=a*Xe,se+=a*Je,te+=a*Ge,fe+=a*Ve,ge+=a*Le,re+=a*ke,_e+=a*Ze,a=I[5],we+=a*Be,$e+=a*Fe,Pe+=a*ze,ye+=a*Ke,pe+=a*He,le+=a*Ue,ue+=a*qe,ce+=a*We,oe+=a*Ye,se+=a*Xe,te+=a*Je,fe+=a*Ge,ge+=a*Ve,re+=a*Le,_e+=a*ke,be+=a*Ze,a=I[6],$e+=a*Be,Pe+=a*Fe,ye+=a*ze,pe+=a*Ke,le+=a*He,ue+=a*Ue,ce+=a*qe,oe+=a*We,se+=a*Ye,te+=a*Xe,fe+=a*Je,ge+=a*Ge,re+=a*Ve,_e+=a*Le,be+=a*ke,Ee+=a*Ze,a=I[7],Pe+=a*Be,ye+=a*Fe,pe+=a*ze,le+=a*Ke,ue+=a*He,ce+=a*Ue,oe+=a*qe,se+=a*We,te+=a*Ye,fe+=a*Xe,ge+=a*Je,re+=a*Ge,_e+=a*Ve,be+=a*Le,Ee+=a*ke,De+=a*Ze,a=I[8],ye+=a*Be,pe+=a*Fe,le+=a*ze,ue+=a*Ke,ce+=a*He,oe+=a*Ue,se+=a*qe,te+=a*We,fe+=a*Ye,ge+=a*Xe,re+=a*Je,_e+=a*Ge,be+=a*Ve,Ee+=a*Le,De+=a*ke,me+=a*Ze,a=I[9],pe+=a*Be,le+=a*Fe,ue+=a*ze,ce+=a*Ke,oe+=a*He,se+=a*Ue,te+=a*qe,fe+=a*We,ge+=a*Ye,re+=a*Xe,_e+=a*Je,be+=a*Ge,Ee+=a*Ve,De+=a*Le,me+=a*ke,Dt+=a*Ze,a=I[10],le+=a*Be,ue+=a*Fe,ce+=a*ze,oe+=a*Ke,se+=a*He,te+=a*Ue,fe+=a*qe,ge+=a*We,re+=a*Ye,_e+=a*Xe,be+=a*Je,Ee+=a*Ge,De+=a*Ve,me+=a*Le,Dt+=a*ke,At+=a*Ze,a=I[11],ue+=a*Be,ce+=a*Fe,oe+=a*ze,se+=a*Ke,te+=a*He,fe+=a*Ue,ge+=a*qe,re+=a*We,_e+=a*Ye,be+=a*Xe,Ee+=a*Je,De+=a*Ge,me+=a*Ve,Dt+=a*Le,At+=a*ke,jt+=a*Ze,a=I[12],ce+=a*Be,oe+=a*Fe,se+=a*ze,te+=a*Ke,fe+=a*He,ge+=a*Ue,re+=a*qe,_e+=a*We,be+=a*Ye,Ee+=a*Xe,De+=a*Je,me+=a*Ge,Dt+=a*Ve,At+=a*Le,jt+=a*ke,pt+=a*Ze,a=I[13],oe+=a*Be,se+=a*Fe,te+=a*ze,fe+=a*Ke,ge+=a*He,re+=a*Ue,_e+=a*qe,be+=a*We,Ee+=a*Ye,De+=a*Xe,me+=a*Je,Dt+=a*Ge,At+=a*Ve,jt+=a*Le,pt+=a*ke,Yt+=a*Ze,a=I[14],se+=a*Be,te+=a*Fe,fe+=a*ze,ge+=a*Ke,re+=a*He,_e+=a*Ue,be+=a*qe,Ee+=a*We,De+=a*Ye,me+=a*Xe,Dt+=a*Je,At+=a*Ge,jt+=a*Ve,pt+=a*Le,Yt+=a*ke,Lr+=a*Ze,a=I[15],te+=a*Be,fe+=a*Fe,ge+=a*ze,re+=a*Ke,_e+=a*He,be+=a*Ue,Ee+=a*qe,De+=a*We,me+=a*Ye,Dt+=a*Xe,At+=a*Je,jt+=a*Ge,pt+=a*Ve,Yt+=a*Le,Lr+=a*ke,hi+=a*Ze,z+=38*fe,H+=38*ge,he+=38*re,ve+=38*_e,de+=38*be,we+=38*Ee,$e+=38*De,Pe+=38*me,ye+=38*Dt,pe+=38*At,le+=38*jt,ue+=38*pt,ce+=38*Yt,oe+=38*Lr,se+=38*hi,y=1,a=z+y+65535,y=Math.floor(a/65536),z=a-y*65536,a=H+y+65535,y=Math.floor(a/65536),H=a-y*65536,a=he+y+65535,y=Math.floor(a/65536),he=a-y*65536,a=ve+y+65535,y=Math.floor(a/65536),ve=a-y*65536,a=de+y+65535,y=Math.floor(a/65536),de=a-y*65536,a=we+y+65535,y=Math.floor(a/65536),we=a-y*65536,a=$e+y+65535,y=Math.floor(a/65536),$e=a-y*65536,a=Pe+y+65535,y=Math.floor(a/65536),Pe=a-y*65536,a=ye+y+65535,y=Math.floor(a/65536),ye=a-y*65536,a=pe+y+65535,y=Math.floor(a/65536),pe=a-y*65536,a=le+y+65535,y=Math.floor(a/65536),le=a-y*65536,a=ue+y+65535,y=Math.floor(a/65536),ue=a-y*65536,a=ce+y+65535,y=Math.floor(a/65536),ce=a-y*65536,a=oe+y+65535,y=Math.floor(a/65536),oe=a-y*65536,a=se+y+65535,y=Math.floor(a/65536),se=a-y*65536,a=te+y+65535,y=Math.floor(a/65536),te=a-y*65536,z+=y-1+37*(y-1),y=1,a=z+y+65535,y=Math.floor(a/65536),z=a-y*65536,a=H+y+65535,y=Math.floor(a/65536),H=a-y*65536,a=he+y+65535,y=Math.floor(a/65536),he=a-y*65536,a=ve+y+65535,y=Math.floor(a/65536),ve=a-y*65536,a=de+y+65535,y=Math.floor(a/65536),de=a-y*65536,a=we+y+65535,y=Math.floor(a/65536),we=a-y*65536,a=$e+y+65535,y=Math.floor(a/65536),$e=a-y*65536,a=Pe+y+65535,y=Math.floor(a/65536),Pe=a-y*65536,a=ye+y+65535,y=Math.floor(a/65536),ye=a-y*65536,a=pe+y+65535,y=Math.floor(a/65536),pe=a-y*65536,a=le+y+65535,y=Math.floor(a/65536),le=a-y*65536,a=ue+y+65535,y=Math.floor(a/65536),ue=a-y*65536,a=ce+y+65535,y=Math.floor(a/65536),ce=a-y*65536,a=oe+y+65535,y=Math.floor(a/65536),oe=a-y*65536,a=se+y+65535,y=Math.floor(a/65536),se=a-y*65536,a=te+y+65535,y=Math.floor(a/65536),te=a-y*65536,z+=y-1+37*(y-1),A[0]=z,A[1]=H,A[2]=he,A[3]=ve,A[4]=de,A[5]=we,A[6]=$e,A[7]=Pe,A[8]=ye,A[9]=pe,A[10]=le,A[11]=ue,A[12]=ce,A[13]=oe,A[14]=se,A[15]=te}function d(A,I){o(A,I,I)}function F(A,I){const D=n();let a;for(a=0;a<16;a++)D[a]=I[a];for(a=253;a>=0;a--)d(D,D),a!==2&&a!==4&&o(D,D,I);for(a=0;a<16;a++)A[a]=D[a]}function K(A,I){const D=n();let a;for(a=0;a<16;a++)D[a]=I[a];for(a=250;a>=0;a--)d(D,D),a!==1&&o(D,D,I);for(a=0;a<16;a++)A[a]=D[a]}function X(A,I){const D=n(),a=n(),y=n(),z=n(),H=n(),he=n(),ve=n(),de=n(),we=n();v(D,A[1],A[0]),v(we,I[1],I[0]),o(D,D,we),_(a,A[0],A[1]),_(we,I[0],I[1]),o(a,a,we),o(y,A[3],I[3]),o(y,y,h),o(z,A[2],I[2]),_(z,z,z),v(H,a,D),v(he,z,y),_(ve,z,y),_(de,a,D),o(A[0],H,he),o(A[1],de,ve),o(A[2],ve,he),o(A[3],H,de)}function J(A,I,D){for(let a=0;a<4;a++)L(A[a],I[a],D)}function k(A,I){const D=n(),a=n(),y=n();F(y,I[2]),o(D,I[0],y),o(a,I[1],y),C(A,a),A[31]^=x(D)<<7}function O(A,I,D){m(A[0],c),m(A[1],u),m(A[2],u),m(A[3],c);for(let a=255;a>=0;--a){const y=D[a/8|0]>>(a&7)&1;J(A,I,y),X(I,A),X(A,A),J(A,I,y)}}function T(A,I){const D=[n(),n(),n(),n()];m(D[0],p),m(D[1],w),m(D[2],u),o(D[3],p,w),O(A,D,I)}function G(A){if(A.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const I=(0,r.hash)(A);I[0]&=248,I[31]&=127,I[31]|=64;const D=new Uint8Array(32),a=[n(),n(),n(),n()];T(a,I),k(D,a);const y=new Uint8Array(64);return y.set(A),y.set(D,32),{publicKey:D,secretKey:y}}t.generateKeyPairFromSeed=G;function W(A){const I=(0,e.randomBytes)(32,A),D=G(I);return(0,i.wipe)(I),D}t.generateKeyPair=W;function P(A){if(A.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(A.subarray(32))}t.extractPublicKeyFromSecretKey=P;const U=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function j(A,I){let D,a,y,z;for(a=63;a>=32;--a){for(D=0,y=a-32,z=a-12;y<z;++y)I[y]+=D-16*I[a]*U[y-(a-32)],D=Math.floor((I[y]+128)/256),I[y]-=D*256;I[y]+=D,I[a]=0}for(D=0,y=0;y<32;y++)I[y]+=D-(I[31]>>4)*U[y],D=I[y]>>8,I[y]&=255;for(y=0;y<32;y++)I[y]-=D*U[y];for(a=0;a<32;a++)I[a+1]+=I[a]>>8,A[a]=I[a]&255}function $(A){const I=new Float64Array(64);for(let D=0;D<64;D++)I[D]=A[D];for(let D=0;D<64;D++)A[D]=0;j(A,I)}function ie(A,I){const D=new Float64Array(64),a=[n(),n(),n(),n()],y=(0,r.hash)(A.subarray(0,32));y[0]&=248,y[31]&=127,y[31]|=64;const z=new Uint8Array(64);z.set(y.subarray(32),32);const H=new r.SHA512;H.update(z.subarray(32)),H.update(I);const he=H.digest();H.clean(),$(he),T(a,he),k(z,a),H.reset(),H.update(z.subarray(0,32)),H.update(A.subarray(32)),H.update(I);const ve=H.digest();$(ve);for(let de=0;de<32;de++)D[de]=he[de];for(let de=0;de<32;de++)for(let we=0;we<32;we++)D[de+we]+=ve[de]*y[we];return j(z.subarray(32),D),z}t.sign=ie;function B(A,I){const D=n(),a=n(),y=n(),z=n(),H=n(),he=n(),ve=n();return m(A[2],u),g(A[1],I),d(y,A[1]),o(z,y,f),v(y,y,A[2]),_(z,A[2],z),d(H,z),d(he,H),o(ve,he,H),o(D,ve,y),o(D,D,z),K(D,D),o(D,D,y),o(D,D,z),o(D,D,z),o(A[0],D,z),d(a,A[0]),o(a,a,z),b(a,y)&&o(A[0],A[0],N),d(a,A[0]),o(a,a,z),b(a,y)?-1:(x(A[0])===I[31]>>7&&v(A[0],c,A[0]),o(A[3],A[0],A[1]),0)}function Q(A,I,D){const a=new Uint8Array(32),y=[n(),n(),n(),n()],z=[n(),n(),n(),n()];if(D.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(B(z,A))return!1;const H=new r.SHA512;H.update(D.subarray(0,32)),H.update(A),H.update(I);const he=H.digest();return $(he),O(y,z,he),T(z,D.subarray(32)),X(y,z),k(a,y),!M(D,a)}t.verify=Q;function Y(A){let I=[n(),n(),n(),n()];if(B(I,A))throw new Error("Ed25519: invalid public key");let D=n(),a=n(),y=I[1];_(D,u,y),v(a,u,y),F(a,a),o(D,D,a);let z=new Uint8Array(32);return C(z,D),z}t.convertPublicKeyToX25519=Y;function ae(A){const I=(0,r.hash)(A.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const D=new Uint8Array(I.subarray(0,32));return(0,i.wipe)(I),D}t.convertSecretKeyToX25519=ae}(Ui);var wr={},zi={},Ki={};Object.defineProperty(Ki,"__esModule",{value:!0});var xs=65536,of=function(){function t(){this.isAvailable=!1,this.isInstantiated=!1;var e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var r=new Uint8Array(e),i=0;i<r.length;i+=xs)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,xs)));return r},t}();Ki.BrowserRandomSource=of;var Hi={};Object.defineProperty(Hi,"__esModule",{value:!0});var af=ct,cf=function(){function t(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof ys<"u"){var e=vs;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var i=new Uint8Array(e),n=0;n<i.length;n++)i[n]=r[n];return af.wipe(r),i},t}();Hi.NodeRandomSource=cf,Object.defineProperty(zi,"__esModule",{value:!0});var uf=Ki,ff=Hi,hf=function(){function t(){if(this.isAvailable=!1,this.name="",this._source=new uf.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new ff.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return t.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},t}();zi.SystemRandomSource=hf,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=zi,r=ee,i=ct;t.defaultRandomSource=new e.SystemRandomSource;function n(h,p){return p===void 0&&(p=t.defaultRandomSource),p.randomBytes(h)}t.randomBytes=n;function s(h){h===void 0&&(h=t.defaultRandomSource);var p=n(4,h),w=r.readUint32LE(p);return i.wipe(p),w}t.randomUint32=s;var c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(h,p,w){if(p===void 0&&(p=c),w===void 0&&(w=t.defaultRandomSource),p.length<2)throw new Error("randomString charset is too short");if(p.length>256)throw new Error("randomString charset is too long");for(var N="",m=p.length,E=256-256%m;h>0;){for(var L=n(Math.ceil(h*256/E),w),C=0;C<L.length&&h>0;C++){var M=L[C];M<E&&(N+=p.charAt(M%m),h--)}i.wipe(L)}return N}t.randomString=u;function f(h,p,w){p===void 0&&(p=c),w===void 0&&(w=t.defaultRandomSource);var N=Math.ceil(h/(Math.log(p.length)/Math.LN2));return u(N,p,w)}t.randomStringForEntropy=f}(wr);const lf="EdDSA",df="JWT",Os=".",Is="base64url",pf="utf8",gf="utf8",yf=":",vf="did",_f="key",As="base58btc",bf="z",wf="K36",mf=32;function Ns(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Vi(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=Ns(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return r}function Ef(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),c=s.charCodeAt(0);if(r[c]!==255)throw new TypeError(s+" is ambiguous");r[c]=n}var u=t.length,f=t.charAt(0),h=Math.log(u)/Math.log(256),p=Math.log(256)/Math.log(u);function w(E){if(E instanceof Uint8Array||(ArrayBuffer.isView(E)?E=new Uint8Array(E.buffer,E.byteOffset,E.byteLength):Array.isArray(E)&&(E=Uint8Array.from(E))),!(E instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(E.length===0)return"";for(var L=0,C=0,M=0,b=E.length;M!==b&&E[M]===0;)M++,L++;for(var x=(b-M)*p+1>>>0,g=new Uint8Array(x);M!==b;){for(var _=E[M],v=0,o=x-1;(_!==0||v<C)&&o!==-1;o--,v++)_+=256*g[o]>>>0,g[o]=_%u>>>0,_=_/u>>>0;if(_!==0)throw new Error("Non-zero carry");C=v,M++}for(var d=x-C;d!==x&&g[d]===0;)d++;for(var F=f.repeat(L);d<x;++d)F+=t.charAt(g[d]);return F}function N(E){if(typeof E!="string")throw new TypeError("Expected String");if(E.length===0)return new Uint8Array;var L=0;if(E[L]!==" "){for(var C=0,M=0;E[L]===f;)C++,L++;for(var b=(E.length-L)*h+1>>>0,x=new Uint8Array(b);E[L];){var g=r[E.charCodeAt(L)];if(g===255)return;for(var _=0,v=b-1;(g!==0||_<M)&&v!==-1;v--,_++)g+=u*x[v]>>>0,x[v]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");M=_,L++}if(E[L]!==" "){for(var o=b-M;o!==b&&x[o]===0;)o++;for(var d=new Uint8Array(C+(b-o)),F=C;o!==b;)d[F++]=x[o++];return d}}}function m(E){var L=N(E);if(L)return L;throw new Error(`Non-${e} character`)}return{encode:w,decodeUnsafe:N,decode:m}}var Df=Ef,Sf=Df;const Ts=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},xf=t=>new TextEncoder().encode(t),Of=t=>new TextDecoder().decode(t);class If{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Af{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Cs(this,e)}}class Nf{constructor(e){this.decoders=e}or(e){return Cs(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Cs=(t,e)=>new Nf({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Tf{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new If(e,r,i),this.decoder=new Af(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Zr=({name:t,prefix:e,encode:r,decode:i})=>new Tf(t,e,r,i),mr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=Sf(r,e);return Zr({prefix:t,name:e,encode:i,decode:s=>Ts(n(s))})},Cf=(t,e,r,i)=>{const n={};for(let p=0;p<e.length;++p)n[e[p]]=p;let s=t.length;for(;t[s-1]==="=";)--s;const c=new Uint8Array(s*r/8|0);let u=0,f=0,h=0;for(let p=0;p<s;++p){const w=n[t[p]];if(w===void 0)throw new SyntaxError(`Non-${i} character`);f=f<<r|w,u+=r,u>=8&&(u-=8,c[h++]=255&f>>u)}if(u>=r||255&f<<8-u)throw new SyntaxError("Unexpected end of data");return c},Lf=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",c=0,u=0;for(let f=0;f<t.length;++f)for(u=u<<8|t[f],c+=8;c>r;)c-=r,s+=e[n&u>>c];if(c&&(s+=e[n&u<<r-c]),i)for(;s.length*r&7;)s+="=";return s},et=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Zr({prefix:e,name:t,encode(n){return Lf(n,i,r)},decode(n){return Cf(n,i,r,t)}}),Rf=Zr({prefix:"\0",name:"identity",encode:t=>Of(t),decode:t=>xf(t)});var Pf=Object.freeze({__proto__:null,identity:Rf});const Ff=et({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Uf=Object.freeze({__proto__:null,base2:Ff});const Mf=et({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var jf=Object.freeze({__proto__:null,base8:Mf});const $f=mr({prefix:"9",name:"base10",alphabet:"0123456789"});var Bf=Object.freeze({__proto__:null,base10:$f});const zf=et({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Kf=et({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Hf=Object.freeze({__proto__:null,base16:zf,base16upper:Kf});const Vf=et({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Gf=et({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),qf=et({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Wf=et({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Yf=et({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Xf=et({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Jf=et({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),kf=et({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Zf=et({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Qf=Object.freeze({__proto__:null,base32:Vf,base32upper:Gf,base32pad:qf,base32padupper:Wf,base32hex:Yf,base32hexupper:Xf,base32hexpad:Jf,base32hexpadupper:kf,base32z:Zf});const eh=mr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),th=mr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var rh=Object.freeze({__proto__:null,base36:eh,base36upper:th});const ih=mr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),nh=mr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var sh=Object.freeze({__proto__:null,base58btc:ih,base58flickr:nh});const oh=et({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ah=et({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ch=et({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),uh=et({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var fh=Object.freeze({__proto__:null,base64:oh,base64pad:ah,base64url:ch,base64urlpad:uh});const Ls=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),hh=Ls.reduce((t,e,r)=>(t[r]=e,t),[]),lh=Ls.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function dh(t){return t.reduce((e,r)=>(e+=hh[r],e),"")}function ph(t){const e=[];for(const r of t){const i=lh[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const gh=Zr({prefix:"\u{1F680}",name:"base256emoji",encode:dh,decode:ph});var yh=Object.freeze({__proto__:null,base256emoji:gh}),vh=Ps,Rs=128,_h=127,bh=~_h,wh=Math.pow(2,31);function Ps(t,e,r){e=e||[],r=r||0;for(var i=r;t>=wh;)e[r++]=t&255|Rs,t/=128;for(;t&bh;)e[r++]=t&255|Rs,t>>>=7;return e[r]=t|0,Ps.bytes=r-i+1,e}var mh=Gi,Eh=128,Fs=127;function Gi(t,i){var r=0,i=i||0,n=0,s=i,c,u=t.length;do{if(s>=u)throw Gi.bytes=0,new RangeError("Could not decode varint");c=t[s++],r+=n<28?(c&Fs)<<n:(c&Fs)*Math.pow(2,n),n+=7}while(c>=Eh);return Gi.bytes=s-i,r}var Dh=Math.pow(2,7),Sh=Math.pow(2,14),xh=Math.pow(2,21),Oh=Math.pow(2,28),Ih=Math.pow(2,35),Ah=Math.pow(2,42),Nh=Math.pow(2,49),Th=Math.pow(2,56),Ch=Math.pow(2,63),Lh=function(t){return t<Dh?1:t<Sh?2:t<xh?3:t<Oh?4:t<Ih?5:t<Ah?6:t<Nh?7:t<Th?8:t<Ch?9:10},Rh={encode:vh,decode:mh,encodingLength:Lh},Us=Rh;const Ms=(t,e,r=0)=>(Us.encode(t,e,r),e),js=t=>Us.encodingLength(t),qi=(t,e)=>{const r=e.byteLength,i=js(t),n=i+js(r),s=new Uint8Array(n+r);return Ms(t,s,0),Ms(r,s,i),s.set(e,n),new Ph(t,r,e,s)};class Ph{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const $s=({name:t,code:e,encode:r})=>new Fh(t,e,r);class Fh{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?qi(this.code,r):r.then(i=>qi(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Bs=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Uh=$s({name:"sha2-256",code:18,encode:Bs("SHA-256")}),Mh=$s({name:"sha2-512",code:19,encode:Bs("SHA-512")});var jh=Object.freeze({__proto__:null,sha256:Uh,sha512:Mh});const zs=0,$h="identity",Ks=Ts;var Bh=Object.freeze({__proto__:null,identity:{code:zs,name:$h,encode:Ks,digest:t=>qi(zs,Ks(t))}});new TextEncoder,new TextDecoder;const Hs={...Pf,...Uf,...jf,...Bf,...Hf,...Qf,...rh,...sh,...fh,...yh};({...jh,...Bh});function Vs(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Gs=Vs("utf8","u",t=>{const e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),Wi=Vs("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Ns(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),qs={utf8:Gs,"utf-8":Gs,hex:Hs.base16,latin1:Wi,ascii:Wi,binary:Wi,...Hs};function ft(t,e="utf8"){const r=qs[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function ht(t,e="utf8"){const r=qs[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function Qr(t){return ft(ht(Fi(t),pf),Is)}function Ws(t){const e=ht(wf,As),r=bf+ft(Vi([e,t]),As);return[vf,_f,r].join(yf)}function zh(t){return ft(t,Is)}function Kh(t){return ht([Qr(t.header),Qr(t.payload)].join(Os),gf)}function Hh(t){return[Qr(t.header),Qr(t.payload),zh(t.signature)].join(Os)}function Ys(t=wr.randomBytes(mf)){return Ui.generateKeyPairFromSeed(t)}async function Vh(t,e,r,i,n=Te.fromMiliseconds(Date.now())){const s={alg:lf,typ:df},c=Ws(i.publicKey),u=n+r,f={iss:c,sub:t,aud:e,iat:n,exp:u},h=Kh({header:s,payload:f}),p=Ui.sign(i.secretKey,h);return Hh({header:s,payload:f,signature:p})}var Yi={},ei={};Object.defineProperty(ei,"__esModule",{value:!0});var it=ee,Xi=ct,Gh=20;function qh(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,c=1797285236,u=r[3]<<24|r[2]<<16|r[1]<<8|r[0],f=r[7]<<24|r[6]<<16|r[5]<<8|r[4],h=r[11]<<24|r[10]<<16|r[9]<<8|r[8],p=r[15]<<24|r[14]<<16|r[13]<<8|r[12],w=r[19]<<24|r[18]<<16|r[17]<<8|r[16],N=r[23]<<24|r[22]<<16|r[21]<<8|r[20],m=r[27]<<24|r[26]<<16|r[25]<<8|r[24],E=r[31]<<24|r[30]<<16|r[29]<<8|r[28],L=e[3]<<24|e[2]<<16|e[1]<<8|e[0],C=e[7]<<24|e[6]<<16|e[5]<<8|e[4],M=e[11]<<24|e[10]<<16|e[9]<<8|e[8],b=e[15]<<24|e[14]<<16|e[13]<<8|e[12],x=i,g=n,_=s,v=c,o=u,d=f,F=h,K=p,X=w,J=N,k=m,O=E,T=L,G=C,W=M,P=b,U=0;U<Gh;U+=2)x=x+o|0,T^=x,T=T>>>32-16|T<<16,X=X+T|0,o^=X,o=o>>>32-12|o<<12,g=g+d|0,G^=g,G=G>>>32-16|G<<16,J=J+G|0,d^=J,d=d>>>32-12|d<<12,_=_+F|0,W^=_,W=W>>>32-16|W<<16,k=k+W|0,F^=k,F=F>>>32-12|F<<12,v=v+K|0,P^=v,P=P>>>32-16|P<<16,O=O+P|0,K^=O,K=K>>>32-12|K<<12,_=_+F|0,W^=_,W=W>>>32-8|W<<8,k=k+W|0,F^=k,F=F>>>32-7|F<<7,v=v+K|0,P^=v,P=P>>>32-8|P<<8,O=O+P|0,K^=O,K=K>>>32-7|K<<7,g=g+d|0,G^=g,G=G>>>32-8|G<<8,J=J+G|0,d^=J,d=d>>>32-7|d<<7,x=x+o|0,T^=x,T=T>>>32-8|T<<8,X=X+T|0,o^=X,o=o>>>32-7|o<<7,x=x+d|0,P^=x,P=P>>>32-16|P<<16,k=k+P|0,d^=k,d=d>>>32-12|d<<12,g=g+F|0,T^=g,T=T>>>32-16|T<<16,O=O+T|0,F^=O,F=F>>>32-12|F<<12,_=_+K|0,G^=_,G=G>>>32-16|G<<16,X=X+G|0,K^=X,K=K>>>32-12|K<<12,v=v+o|0,W^=v,W=W>>>32-16|W<<16,J=J+W|0,o^=J,o=o>>>32-12|o<<12,_=_+K|0,G^=_,G=G>>>32-8|G<<8,X=X+G|0,K^=X,K=K>>>32-7|K<<7,v=v+o|0,W^=v,W=W>>>32-8|W<<8,J=J+W|0,o^=J,o=o>>>32-7|o<<7,g=g+F|0,T^=g,T=T>>>32-8|T<<8,O=O+T|0,F^=O,F=F>>>32-7|F<<7,x=x+d|0,P^=x,P=P>>>32-8|P<<8,k=k+P|0,d^=k,d=d>>>32-7|d<<7;it.writeUint32LE(x+i|0,t,0),it.writeUint32LE(g+n|0,t,4),it.writeUint32LE(_+s|0,t,8),it.writeUint32LE(v+c|0,t,12),it.writeUint32LE(o+u|0,t,16),it.writeUint32LE(d+f|0,t,20),it.writeUint32LE(F+h|0,t,24),it.writeUint32LE(K+p|0,t,28),it.writeUint32LE(X+w|0,t,32),it.writeUint32LE(J+N|0,t,36),it.writeUint32LE(k+m|0,t,40),it.writeUint32LE(O+E|0,t,44),it.writeUint32LE(T+L|0,t,48),it.writeUint32LE(G+C|0,t,52),it.writeUint32LE(W+M|0,t,56),it.writeUint32LE(P+b|0,t,60)}function Xs(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,c;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),c=s.length-e.length,s.set(e,c)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,c=n}for(var u=new Uint8Array(64),f=0;f<r.length;f+=64){qh(u,s,t);for(var h=f;h<f+64&&h<r.length;h++)i[h]=r[h]^u[h-f];Yh(s,0,c)}return Xi.wipe(u),n===0&&Xi.wipe(s),i}ei.streamXOR=Xs;function Wh(t,e,r,i){return i===void 0&&(i=0),Xi.wipe(r),Xs(t,e,r,r,i)}ei.stream=Wh;function Yh(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var Js={},Pt={};Object.defineProperty(Pt,"__esModule",{value:!0});function Xh(t,e,r){return~(t-1)&e|t-1&r}Pt.select=Xh;function Jh(t,e){return(t|0)-(e|0)-1>>>31&1}Pt.lessOrEqual=Jh;function ks(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}Pt.compare=ks;function kh(t,e){return t.length===0||e.length===0?!1:ks(t,e)!==0}Pt.equal=kh,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Pt,r=ct;t.DIGEST_LENGTH=16;var i=function(){function c(u){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var f=u[0]|u[1]<<8;this._r[0]=f&8191;var h=u[2]|u[3]<<8;this._r[1]=(f>>>13|h<<3)&8191;var p=u[4]|u[5]<<8;this._r[2]=(h>>>10|p<<6)&7939;var w=u[6]|u[7]<<8;this._r[3]=(p>>>7|w<<9)&8191;var N=u[8]|u[9]<<8;this._r[4]=(w>>>4|N<<12)&255,this._r[5]=N>>>1&8190;var m=u[10]|u[11]<<8;this._r[6]=(N>>>14|m<<2)&8191;var E=u[12]|u[13]<<8;this._r[7]=(m>>>11|E<<5)&8065;var L=u[14]|u[15]<<8;this._r[8]=(E>>>8|L<<8)&8191,this._r[9]=L>>>5&127,this._pad[0]=u[16]|u[17]<<8,this._pad[1]=u[18]|u[19]<<8,this._pad[2]=u[20]|u[21]<<8,this._pad[3]=u[22]|u[23]<<8,this._pad[4]=u[24]|u[25]<<8,this._pad[5]=u[26]|u[27]<<8,this._pad[6]=u[28]|u[29]<<8,this._pad[7]=u[30]|u[31]<<8}return c.prototype._blocks=function(u,f,h){for(var p=this._fin?0:2048,w=this._h[0],N=this._h[1],m=this._h[2],E=this._h[3],L=this._h[4],C=this._h[5],M=this._h[6],b=this._h[7],x=this._h[8],g=this._h[9],_=this._r[0],v=this._r[1],o=this._r[2],d=this._r[3],F=this._r[4],K=this._r[5],X=this._r[6],J=this._r[7],k=this._r[8],O=this._r[9];h>=16;){var T=u[f+0]|u[f+1]<<8;w+=T&8191;var G=u[f+2]|u[f+3]<<8;N+=(T>>>13|G<<3)&8191;var W=u[f+4]|u[f+5]<<8;m+=(G>>>10|W<<6)&8191;var P=u[f+6]|u[f+7]<<8;E+=(W>>>7|P<<9)&8191;var U=u[f+8]|u[f+9]<<8;L+=(P>>>4|U<<12)&8191,C+=U>>>1&8191;var j=u[f+10]|u[f+11]<<8;M+=(U>>>14|j<<2)&8191;var $=u[f+12]|u[f+13]<<8;b+=(j>>>11|$<<5)&8191;var ie=u[f+14]|u[f+15]<<8;x+=($>>>8|ie<<8)&8191,g+=ie>>>5|p;var B=0,Q=B;Q+=w*_,Q+=N*(5*O),Q+=m*(5*k),Q+=E*(5*J),Q+=L*(5*X),B=Q>>>13,Q&=8191,Q+=C*(5*K),Q+=M*(5*F),Q+=b*(5*d),Q+=x*(5*o),Q+=g*(5*v),B+=Q>>>13,Q&=8191;var Y=B;Y+=w*v,Y+=N*_,Y+=m*(5*O),Y+=E*(5*k),Y+=L*(5*J),B=Y>>>13,Y&=8191,Y+=C*(5*X),Y+=M*(5*K),Y+=b*(5*F),Y+=x*(5*d),Y+=g*(5*o),B+=Y>>>13,Y&=8191;var ae=B;ae+=w*o,ae+=N*v,ae+=m*_,ae+=E*(5*O),ae+=L*(5*k),B=ae>>>13,ae&=8191,ae+=C*(5*J),ae+=M*(5*X),ae+=b*(5*K),ae+=x*(5*F),ae+=g*(5*d),B+=ae>>>13,ae&=8191;var A=B;A+=w*d,A+=N*o,A+=m*v,A+=E*_,A+=L*(5*O),B=A>>>13,A&=8191,A+=C*(5*k),A+=M*(5*J),A+=b*(5*X),A+=x*(5*K),A+=g*(5*F),B+=A>>>13,A&=8191;var I=B;I+=w*F,I+=N*d,I+=m*o,I+=E*v,I+=L*_,B=I>>>13,I&=8191,I+=C*(5*O),I+=M*(5*k),I+=b*(5*J),I+=x*(5*X),I+=g*(5*K),B+=I>>>13,I&=8191;var D=B;D+=w*K,D+=N*F,D+=m*d,D+=E*o,D+=L*v,B=D>>>13,D&=8191,D+=C*_,D+=M*(5*O),D+=b*(5*k),D+=x*(5*J),D+=g*(5*X),B+=D>>>13,D&=8191;var a=B;a+=w*X,a+=N*K,a+=m*F,a+=E*d,a+=L*o,B=a>>>13,a&=8191,a+=C*v,a+=M*_,a+=b*(5*O),a+=x*(5*k),a+=g*(5*J),B+=a>>>13,a&=8191;var y=B;y+=w*J,y+=N*X,y+=m*K,y+=E*F,y+=L*d,B=y>>>13,y&=8191,y+=C*o,y+=M*v,y+=b*_,y+=x*(5*O),y+=g*(5*k),B+=y>>>13,y&=8191;var z=B;z+=w*k,z+=N*J,z+=m*X,z+=E*K,z+=L*F,B=z>>>13,z&=8191,z+=C*d,z+=M*o,z+=b*v,z+=x*_,z+=g*(5*O),B+=z>>>13,z&=8191;var H=B;H+=w*O,H+=N*k,H+=m*J,H+=E*X,H+=L*K,B=H>>>13,H&=8191,H+=C*F,H+=M*d,H+=b*o,H+=x*v,H+=g*_,B+=H>>>13,H&=8191,B=(B<<2)+B|0,B=B+Q|0,Q=B&8191,B=B>>>13,Y+=B,w=Q,N=Y,m=ae,E=A,L=I,C=D,M=a,b=y,x=z,g=H,f+=16,h-=16}this._h[0]=w,this._h[1]=N,this._h[2]=m,this._h[3]=E,this._h[4]=L,this._h[5]=C,this._h[6]=M,this._h[7]=b,this._h[8]=x,this._h[9]=g},c.prototype.finish=function(u,f){f===void 0&&(f=0);var h=new Uint16Array(10),p,w,N,m;if(this._leftover){for(m=this._leftover,this._buffer[m++]=1;m<16;m++)this._buffer[m]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(p=this._h[1]>>>13,this._h[1]&=8191,m=2;m<10;m++)this._h[m]+=p,p=this._h[m]>>>13,this._h[m]&=8191;for(this._h[0]+=p*5,p=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=p,p=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=p,h[0]=this._h[0]+5,p=h[0]>>>13,h[0]&=8191,m=1;m<10;m++)h[m]=this._h[m]+p,p=h[m]>>>13,h[m]&=8191;for(h[9]-=1<<13,w=(p^1)-1,m=0;m<10;m++)h[m]&=w;for(w=~w,m=0;m<10;m++)this._h[m]=this._h[m]&w|h[m];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,N=this._h[0]+this._pad[0],this._h[0]=N&65535,m=1;m<8;m++)N=(this._h[m]+this._pad[m]|0)+(N>>>16)|0,this._h[m]=N&65535;return u[f+0]=this._h[0]>>>0,u[f+1]=this._h[0]>>>8,u[f+2]=this._h[1]>>>0,u[f+3]=this._h[1]>>>8,u[f+4]=this._h[2]>>>0,u[f+5]=this._h[2]>>>8,u[f+6]=this._h[3]>>>0,u[f+7]=this._h[3]>>>8,u[f+8]=this._h[4]>>>0,u[f+9]=this._h[4]>>>8,u[f+10]=this._h[5]>>>0,u[f+11]=this._h[5]>>>8,u[f+12]=this._h[6]>>>0,u[f+13]=this._h[6]>>>8,u[f+14]=this._h[7]>>>0,u[f+15]=this._h[7]>>>8,this._finished=!0,this},c.prototype.update=function(u){var f=0,h=u.length,p;if(this._leftover){p=16-this._leftover,p>h&&(p=h);for(var w=0;w<p;w++)this._buffer[this._leftover+w]=u[f+w];if(h-=p,f+=p,this._leftover+=p,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(h>=16&&(p=h-h%16,this._blocks(u,f,p),f+=p,h-=p),h){for(var w=0;w<h;w++)this._buffer[this._leftover+w]=u[f+w];this._leftover+=h}return this},c.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var u=new Uint8Array(16);return this.finish(u),u},c.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},c}();t.Poly1305=i;function n(c,u){var f=new i(c);f.update(u);var h=f.digest();return f.clean(),h}t.oneTimeAuth=n;function s(c,u){return c.length!==t.DIGEST_LENGTH||u.length!==t.DIGEST_LENGTH?!1:e.equal(c,u)}t.equal=s}(Js),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ei,r=Js,i=ct,n=ee,s=Pt;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var c=new Uint8Array(16),u=function(){function f(h){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,h.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(h)}return f.prototype.seal=function(h,p,w,N){if(h.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var m=new Uint8Array(16);m.set(h,m.length-h.length);var E=new Uint8Array(32);e.stream(this._key,m,E,4);var L=p.length+this.tagLength,C;if(N){if(N.length!==L)throw new Error("ChaCha20Poly1305: incorrect destination length");C=N}else C=new Uint8Array(L);return e.streamXOR(this._key,m,p,C,4),this._authenticate(C.subarray(C.length-this.tagLength,C.length),E,C.subarray(0,C.length-this.tagLength),w),i.wipe(m),C},f.prototype.open=function(h,p,w,N){if(h.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(p.length<this.tagLength)return null;var m=new Uint8Array(16);m.set(h,m.length-h.length);var E=new Uint8Array(32);e.stream(this._key,m,E,4);var L=new Uint8Array(this.tagLength);if(this._authenticate(L,E,p.subarray(0,p.length-this.tagLength),w),!s.equal(L,p.subarray(p.length-this.tagLength,p.length)))return null;var C=p.length-this.tagLength,M;if(N){if(N.length!==C)throw new Error("ChaCha20Poly1305: incorrect destination length");M=N}else M=new Uint8Array(C);return e.streamXOR(this._key,m,p.subarray(0,p.length-this.tagLength),M,4),i.wipe(m),M},f.prototype.clean=function(){return i.wipe(this._key),this},f.prototype._authenticate=function(h,p,w,N){var m=new r.Poly1305(p);N&&(m.update(N),N.length%16>0&&m.update(c.subarray(N.length%16))),m.update(w),w.length%16>0&&m.update(c.subarray(w.length%16));var E=new Uint8Array(8);N&&n.writeUint64LE(N.length,E),m.update(E),n.writeUint64LE(w.length,E),m.update(E);for(var L=m.digest(),C=0;C<L.length;C++)h[C]=L[C];m.clean(),i.wipe(L),i.wipe(E)},f}();t.ChaCha20Poly1305=u}(Yi);var Zs={},Er={},Ji={};Object.defineProperty(Ji,"__esModule",{value:!0});function Zh(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}Ji.isSerializableHash=Zh,Object.defineProperty(Er,"__esModule",{value:!0});var Ot=Ji,Qh=Pt,el=ct,Qs=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),Ot.isSerializableHash(this._inner)&&Ot.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),el.wipe(i)}return t.prototype.reset=function(){if(!Ot.isSerializableHash(this._inner)||!Ot.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Ot.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Ot.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Ot.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Ot.isSerializableHash(this._inner)||!Ot.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Ot.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Er.HMAC=Qs;function tl(t,e,r){var i=new Qs(t,e);i.update(r);var n=i.digest();return i.clean(),n}Er.hmac=tl,Er.equal=Qh.equal,Object.defineProperty(Zs,"__esModule",{value:!0});var eo=Er,to=ct,rl=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=eo.hmac(this._hash,i,r);this._hmac=new eo.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),to.wipe(this._buffer),to.wipe(this._counter),this._bufpos=0},t}(),il=Zs.HKDF=rl,ti={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ee,r=ct;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},u.prototype.update=function(f,h){if(h===void 0&&(h=f.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var p=0;if(this._bytesHashed+=h,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&h>0;)this._buffer[this._bufferLength++]=f[p++],h--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(h>=this.blockSize&&(p=s(this._temp,this._state,f,p,h),h%=this.blockSize);h>0;)this._buffer[this._bufferLength++]=f[p++],h--;return this},u.prototype.finish=function(f){if(!this._finished){var h=this._bytesHashed,p=this._bufferLength,w=h/536870912|0,N=h<<3,m=h%64<56?64:128;this._buffer[p]=128;for(var E=p+1;E<m-8;E++)this._buffer[E]=0;e.writeUint32BE(w,this._buffer,m-8),e.writeUint32BE(N,this._buffer,m-4),s(this._temp,this._state,this._buffer,0,m),this._finished=!0}for(var E=0;E<this.digestLength/4;E++)e.writeUint32BE(this._state[E],f,E*4);return this},u.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(f){return this._state.set(f.state),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(f){r.wipe(f.state),f.buffer&&r.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},u}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(u,f,h,p,w){for(;w>=64;){for(var N=f[0],m=f[1],E=f[2],L=f[3],C=f[4],M=f[5],b=f[6],x=f[7],g=0;g<16;g++){var _=p+g*4;u[g]=e.readUint32BE(h,_)}for(var g=16;g<64;g++){var v=u[g-2],o=(v>>>17|v<<32-17)^(v>>>19|v<<32-19)^v>>>10;v=u[g-15];var d=(v>>>7|v<<32-7)^(v>>>18|v<<32-18)^v>>>3;u[g]=(o+u[g-7]|0)+(d+u[g-16]|0)}for(var g=0;g<64;g++){var o=(((C>>>6|C<<26)^(C>>>11|C<<21)^(C>>>25|C<<7))+(C&M^~C&b)|0)+(x+(n[g]+u[g]|0)|0)|0,d=((N>>>2|N<<32-2)^(N>>>13|N<<32-13)^(N>>>22|N<<32-22))+(N&m^N&E^m&E)|0;x=b,b=M,M=C,C=L+o|0,L=E,E=m,m=N,N=o+d|0}f[0]+=N,f[1]+=m,f[2]+=E,f[3]+=L,f[4]+=C,f[5]+=M,f[6]+=b,f[7]+=x,p+=64,w-=64}return p}function c(u){var f=new i;f.update(u);var h=f.digest();return f.clean(),h}t.hash=c})(ti);var ki={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=wr,r=ct;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(g){var _=new Float64Array(16);if(g)for(var v=0;v<g.length;v++)_[v]=g[v];return _}var n=new Uint8Array(32);n[0]=9;var s=i([56129,1]);function c(g){for(var _=1,v=0;v<16;v++){var o=g[v]+_+65535;_=Math.floor(o/65536),g[v]=o-_*65536}g[0]+=_-1+37*(_-1)}function u(g,_,v){for(var o=~(v-1),d=0;d<16;d++){var F=o&(g[d]^_[d]);g[d]^=F,_[d]^=F}}function f(g,_){for(var v=i(),o=i(),d=0;d<16;d++)o[d]=_[d];c(o),c(o),c(o);for(var F=0;F<2;F++){v[0]=o[0]-65517;for(var d=1;d<15;d++)v[d]=o[d]-65535-(v[d-1]>>16&1),v[d-1]&=65535;v[15]=o[15]-32767-(v[14]>>16&1);var K=v[15]>>16&1;v[14]&=65535,u(o,v,1-K)}for(var d=0;d<16;d++)g[2*d]=o[d]&255,g[2*d+1]=o[d]>>8}function h(g,_){for(var v=0;v<16;v++)g[v]=_[2*v]+(_[2*v+1]<<8);g[15]&=32767}function p(g,_,v){for(var o=0;o<16;o++)g[o]=_[o]+v[o]}function w(g,_,v){for(var o=0;o<16;o++)g[o]=_[o]-v[o]}function N(g,_,v){var o,d,F=0,K=0,X=0,J=0,k=0,O=0,T=0,G=0,W=0,P=0,U=0,j=0,$=0,ie=0,B=0,Q=0,Y=0,ae=0,A=0,I=0,D=0,a=0,y=0,z=0,H=0,he=0,ve=0,de=0,we=0,$e=0,Pe=0,ye=v[0],pe=v[1],le=v[2],ue=v[3],ce=v[4],oe=v[5],se=v[6],te=v[7],fe=v[8],ge=v[9],re=v[10],_e=v[11],be=v[12],Ee=v[13],De=v[14],me=v[15];o=_[0],F+=o*ye,K+=o*pe,X+=o*le,J+=o*ue,k+=o*ce,O+=o*oe,T+=o*se,G+=o*te,W+=o*fe,P+=o*ge,U+=o*re,j+=o*_e,$+=o*be,ie+=o*Ee,B+=o*De,Q+=o*me,o=_[1],K+=o*ye,X+=o*pe,J+=o*le,k+=o*ue,O+=o*ce,T+=o*oe,G+=o*se,W+=o*te,P+=o*fe,U+=o*ge,j+=o*re,$+=o*_e,ie+=o*be,B+=o*Ee,Q+=o*De,Y+=o*me,o=_[2],X+=o*ye,J+=o*pe,k+=o*le,O+=o*ue,T+=o*ce,G+=o*oe,W+=o*se,P+=o*te,U+=o*fe,j+=o*ge,$+=o*re,ie+=o*_e,B+=o*be,Q+=o*Ee,Y+=o*De,ae+=o*me,o=_[3],J+=o*ye,k+=o*pe,O+=o*le,T+=o*ue,G+=o*ce,W+=o*oe,P+=o*se,U+=o*te,j+=o*fe,$+=o*ge,ie+=o*re,B+=o*_e,Q+=o*be,Y+=o*Ee,ae+=o*De,A+=o*me,o=_[4],k+=o*ye,O+=o*pe,T+=o*le,G+=o*ue,W+=o*ce,P+=o*oe,U+=o*se,j+=o*te,$+=o*fe,ie+=o*ge,B+=o*re,Q+=o*_e,Y+=o*be,ae+=o*Ee,A+=o*De,I+=o*me,o=_[5],O+=o*ye,T+=o*pe,G+=o*le,W+=o*ue,P+=o*ce,U+=o*oe,j+=o*se,$+=o*te,ie+=o*fe,B+=o*ge,Q+=o*re,Y+=o*_e,ae+=o*be,A+=o*Ee,I+=o*De,D+=o*me,o=_[6],T+=o*ye,G+=o*pe,W+=o*le,P+=o*ue,U+=o*ce,j+=o*oe,$+=o*se,ie+=o*te,B+=o*fe,Q+=o*ge,Y+=o*re,ae+=o*_e,A+=o*be,I+=o*Ee,D+=o*De,a+=o*me,o=_[7],G+=o*ye,W+=o*pe,P+=o*le,U+=o*ue,j+=o*ce,$+=o*oe,ie+=o*se,B+=o*te,Q+=o*fe,Y+=o*ge,ae+=o*re,A+=o*_e,I+=o*be,D+=o*Ee,a+=o*De,y+=o*me,o=_[8],W+=o*ye,P+=o*pe,U+=o*le,j+=o*ue,$+=o*ce,ie+=o*oe,B+=o*se,Q+=o*te,Y+=o*fe,ae+=o*ge,A+=o*re,I+=o*_e,D+=o*be,a+=o*Ee,y+=o*De,z+=o*me,o=_[9],P+=o*ye,U+=o*pe,j+=o*le,$+=o*ue,ie+=o*ce,B+=o*oe,Q+=o*se,Y+=o*te,ae+=o*fe,A+=o*ge,I+=o*re,D+=o*_e,a+=o*be,y+=o*Ee,z+=o*De,H+=o*me,o=_[10],U+=o*ye,j+=o*pe,$+=o*le,ie+=o*ue,B+=o*ce,Q+=o*oe,Y+=o*se,ae+=o*te,A+=o*fe,I+=o*ge,D+=o*re,a+=o*_e,y+=o*be,z+=o*Ee,H+=o*De,he+=o*me,o=_[11],j+=o*ye,$+=o*pe,ie+=o*le,B+=o*ue,Q+=o*ce,Y+=o*oe,ae+=o*se,A+=o*te,I+=o*fe,D+=o*ge,a+=o*re,y+=o*_e,z+=o*be,H+=o*Ee,he+=o*De,ve+=o*me,o=_[12],$+=o*ye,ie+=o*pe,B+=o*le,Q+=o*ue,Y+=o*ce,ae+=o*oe,A+=o*se,I+=o*te,D+=o*fe,a+=o*ge,y+=o*re,z+=o*_e,H+=o*be,he+=o*Ee,ve+=o*De,de+=o*me,o=_[13],ie+=o*ye,B+=o*pe,Q+=o*le,Y+=o*ue,ae+=o*ce,A+=o*oe,I+=o*se,D+=o*te,a+=o*fe,y+=o*ge,z+=o*re,H+=o*_e,he+=o*be,ve+=o*Ee,de+=o*De,we+=o*me,o=_[14],B+=o*ye,Q+=o*pe,Y+=o*le,ae+=o*ue,A+=o*ce,I+=o*oe,D+=o*se,a+=o*te,y+=o*fe,z+=o*ge,H+=o*re,he+=o*_e,ve+=o*be,de+=o*Ee,we+=o*De,$e+=o*me,o=_[15],Q+=o*ye,Y+=o*pe,ae+=o*le,A+=o*ue,I+=o*ce,D+=o*oe,a+=o*se,y+=o*te,z+=o*fe,H+=o*ge,he+=o*re,ve+=o*_e,de+=o*be,we+=o*Ee,$e+=o*De,Pe+=o*me,F+=38*Y,K+=38*ae,X+=38*A,J+=38*I,k+=38*D,O+=38*a,T+=38*y,G+=38*z,W+=38*H,P+=38*he,U+=38*ve,j+=38*de,$+=38*we,ie+=38*$e,B+=38*Pe,d=1,o=F+d+65535,d=Math.floor(o/65536),F=o-d*65536,o=K+d+65535,d=Math.floor(o/65536),K=o-d*65536,o=X+d+65535,d=Math.floor(o/65536),X=o-d*65536,o=J+d+65535,d=Math.floor(o/65536),J=o-d*65536,o=k+d+65535,d=Math.floor(o/65536),k=o-d*65536,o=O+d+65535,d=Math.floor(o/65536),O=o-d*65536,o=T+d+65535,d=Math.floor(o/65536),T=o-d*65536,o=G+d+65535,d=Math.floor(o/65536),G=o-d*65536,o=W+d+65535,d=Math.floor(o/65536),W=o-d*65536,o=P+d+65535,d=Math.floor(o/65536),P=o-d*65536,o=U+d+65535,d=Math.floor(o/65536),U=o-d*65536,o=j+d+65535,d=Math.floor(o/65536),j=o-d*65536,o=$+d+65535,d=Math.floor(o/65536),$=o-d*65536,o=ie+d+65535,d=Math.floor(o/65536),ie=o-d*65536,o=B+d+65535,d=Math.floor(o/65536),B=o-d*65536,o=Q+d+65535,d=Math.floor(o/65536),Q=o-d*65536,F+=d-1+37*(d-1),d=1,o=F+d+65535,d=Math.floor(o/65536),F=o-d*65536,o=K+d+65535,d=Math.floor(o/65536),K=o-d*65536,o=X+d+65535,d=Math.floor(o/65536),X=o-d*65536,o=J+d+65535,d=Math.floor(o/65536),J=o-d*65536,o=k+d+65535,d=Math.floor(o/65536),k=o-d*65536,o=O+d+65535,d=Math.floor(o/65536),O=o-d*65536,o=T+d+65535,d=Math.floor(o/65536),T=o-d*65536,o=G+d+65535,d=Math.floor(o/65536),G=o-d*65536,o=W+d+65535,d=Math.floor(o/65536),W=o-d*65536,o=P+d+65535,d=Math.floor(o/65536),P=o-d*65536,o=U+d+65535,d=Math.floor(o/65536),U=o-d*65536,o=j+d+65535,d=Math.floor(o/65536),j=o-d*65536,o=$+d+65535,d=Math.floor(o/65536),$=o-d*65536,o=ie+d+65535,d=Math.floor(o/65536),ie=o-d*65536,o=B+d+65535,d=Math.floor(o/65536),B=o-d*65536,o=Q+d+65535,d=Math.floor(o/65536),Q=o-d*65536,F+=d-1+37*(d-1),g[0]=F,g[1]=K,g[2]=X,g[3]=J,g[4]=k,g[5]=O,g[6]=T,g[7]=G,g[8]=W,g[9]=P,g[10]=U,g[11]=j,g[12]=$,g[13]=ie,g[14]=B,g[15]=Q}function m(g,_){N(g,_,_)}function E(g,_){for(var v=i(),o=0;o<16;o++)v[o]=_[o];for(var o=253;o>=0;o--)m(v,v),o!==2&&o!==4&&N(v,v,_);for(var o=0;o<16;o++)g[o]=v[o]}function L(g,_){for(var v=new Uint8Array(32),o=new Float64Array(80),d=i(),F=i(),K=i(),X=i(),J=i(),k=i(),O=0;O<31;O++)v[O]=g[O];v[31]=g[31]&127|64,v[0]&=248,h(o,_);for(var O=0;O<16;O++)F[O]=o[O];d[0]=X[0]=1;for(var O=254;O>=0;--O){var T=v[O>>>3]>>>(O&7)&1;u(d,F,T),u(K,X,T),p(J,d,K),w(d,d,K),p(K,F,X),w(F,F,X),m(X,J),m(k,d),N(d,K,d),N(K,F,J),p(J,d,K),w(d,d,K),m(F,d),w(K,X,k),N(d,K,s),p(d,d,X),N(K,K,d),N(d,X,k),N(X,F,o),m(F,J),u(d,F,T),u(K,X,T)}for(var O=0;O<16;O++)o[O+16]=d[O],o[O+32]=K[O],o[O+48]=F[O],o[O+64]=X[O];var G=o.subarray(32),W=o.subarray(16);E(G,G),N(W,W,G);var P=new Uint8Array(32);return f(P,W),P}t.scalarMult=L;function C(g){return L(g,n)}t.scalarMultBase=C;function M(g){if(g.length!==t.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+t.SECRET_KEY_LENGTH+" bytes");var _=new Uint8Array(g),v=C(_);return{publicKey:v,secretKey:_}}t.generateKeyPairFromSeed=M;function b(g){var _=e.randomBytes(32,g),v=M(_);return r.wipe(_),v}t.generateKeyPair=b;function x(g,_,v){if(v===void 0&&(v=!1),g.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(_.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var o=L(g,_);if(v){for(var d=0,F=0;F<o.length;F++)d|=o[F];if(d===0)throw new Error("X25519: invalid shared key")}return o}t.sharedKey=x})(ki);var ro=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},nl=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),sl=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),ol=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),al=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),cl=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),ul=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,fl=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,io=3,hl=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",ul]],no=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function ll(t){return t?so(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new cl:typeof navigator<"u"?so(navigator.userAgent):gl()}function dl(t){return t!==""&&hl.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function so(t){var e=dl(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new al;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<io&&(n=ro(ro([],n,!0),yl(io-n.length),!0)):n=[];var s=n.join("."),c=pl(t),u=fl.exec(t);return u&&u[1]?new ol(r,s,c,u[1]):new nl(r,s,c)}function pl(t){for(var e=0,r=no.length;e<r;e++){var i=no[e],n=i[0],s=i[1],c=s.exec(t);if(c)return n}return null}function gl(){var t=typeof process<"u"&&process.version;return t?new sl(process.version.slice(1)):null}function yl(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Ne={};Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.getLocalStorage=Ne.getLocalStorageOrThrow=Ne.getCrypto=Ne.getCryptoOrThrow=ao=Ne.getLocation=Ne.getLocationOrThrow=Zi=Ne.getNavigator=Ne.getNavigatorOrThrow=oo=Ne.getDocument=Ne.getDocumentOrThrow=Ne.getFromWindowOrThrow=Ne.getFromWindow=void 0;function Vt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Ne.getFromWindow=Vt;function or(t){const e=Vt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Ne.getFromWindowOrThrow=or;function vl(){return or("document")}Ne.getDocumentOrThrow=vl;function _l(){return Vt("document")}var oo=Ne.getDocument=_l;function bl(){return or("navigator")}Ne.getNavigatorOrThrow=bl;function wl(){return Vt("navigator")}var Zi=Ne.getNavigator=wl;function ml(){return or("location")}Ne.getLocationOrThrow=ml;function El(){return Vt("location")}var ao=Ne.getLocation=El;function Dl(){return or("crypto")}Ne.getCryptoOrThrow=Dl;function Sl(){return Vt("crypto")}Ne.getCrypto=Sl;function xl(){return or("localStorage")}Ne.getLocalStorageOrThrow=xl;function Ol(){return Vt("localStorage")}Ne.getLocalStorage=Ol;var Qi={};Object.defineProperty(Qi,"__esModule",{value:!0});var co=Qi.getWindowMetadata=void 0;const uo=Ne;function Il(){let t,e;try{t=uo.getDocumentOrThrow(),e=uo.getLocationOrThrow()}catch{return null}function r(){const w=t.getElementsByTagName("link"),N=[];for(let m=0;m<w.length;m++){const E=w[m],L=E.getAttribute("rel");if(L&&L.toLowerCase().indexOf("icon")>-1){const C=E.getAttribute("href");if(C)if(C.toLowerCase().indexOf("https:")===-1&&C.toLowerCase().indexOf("http:")===-1&&C.indexOf("//")!==0){let M=e.protocol+"//"+e.host;if(C.indexOf("/")===0)M+=C;else{const b=e.pathname.split("/");b.pop(),M+=b.join("/")+"/"+C}N.push(M)}else if(C.indexOf("//")===0){const M=e.protocol+C;N.push(M)}else N.push(C)}}return N}function i(...w){const N=t.getElementsByTagName("meta");for(let m=0;m<N.length;m++){const E=N[m],L=["itemprop","property","name"].map(C=>E.getAttribute(C)).filter(C=>C?w.includes(C):!1);if(L.length&&L){const C=E.getAttribute("content");if(C)return C}}return""}function n(){let w=i("name","og:site_name","og:title","twitter:title");return w||(w=t.title),w}function s(){return i("description","og:description","twitter:description","keywords")}const c=n(),u=s(),f=e.origin,h=r();return{description:u,url:f,icons:h,name:c}}co=Qi.getWindowMetadata=Il;var Dr={},Al=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),fo="%[a-f0-9]{2}",ho=new RegExp(fo,"gi"),lo=new RegExp("("+fo+")+","gi");function en(t,e){try{return decodeURIComponent(t.join(""))}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],en(r),en(i))}function Nl(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(ho),r=1;r<e.length;r++)t=en(e,r).join(""),e=t.match(ho);return t}}function Tl(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=lo.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=Nl(r[0]);i!==r[0]&&(e[r[0]]=i)}r=lo.exec(t)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),s=0;s<n.length;s++){var c=n[s];t=t.replace(new RegExp(c,"g"),e[c])}return t}var Cl=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return Tl(t)}},Ll=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},Rl=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),s=0;s<i.length;s++){var c=i[s],u=t[c];(n?e.indexOf(c)!==-1:e(c,u,t))&&(r[c]=u)}return r};(function(t){const e=Al,r=Cl,i=Ll,n=Rl,s=b=>b==null,c=Symbol("encodeFragmentIdentifier");function u(b){switch(b.arrayFormat){case"index":return x=>(g,_)=>{const v=g.length;return _===void 0||b.skipNull&&_===null||b.skipEmptyString&&_===""?g:_===null?[...g,[p(x,b),"[",v,"]"].join("")]:[...g,[p(x,b),"[",p(v,b),"]=",p(_,b)].join("")]};case"bracket":return x=>(g,_)=>_===void 0||b.skipNull&&_===null||b.skipEmptyString&&_===""?g:_===null?[...g,[p(x,b),"[]"].join("")]:[...g,[p(x,b),"[]=",p(_,b)].join("")];case"colon-list-separator":return x=>(g,_)=>_===void 0||b.skipNull&&_===null||b.skipEmptyString&&_===""?g:_===null?[...g,[p(x,b),":list="].join("")]:[...g,[p(x,b),":list=",p(_,b)].join("")];case"comma":case"separator":case"bracket-separator":{const x=b.arrayFormat==="bracket-separator"?"[]=":"=";return g=>(_,v)=>v===void 0||b.skipNull&&v===null||b.skipEmptyString&&v===""?_:(v=v===null?"":v,_.length===0?[[p(g,b),x,p(v,b)].join("")]:[[_,p(v,b)].join(b.arrayFormatSeparator)])}default:return x=>(g,_)=>_===void 0||b.skipNull&&_===null||b.skipEmptyString&&_===""?g:_===null?[...g,p(x,b)]:[...g,[p(x,b),"=",p(_,b)].join("")]}}function f(b){let x;switch(b.arrayFormat){case"index":return(g,_,v)=>{if(x=/\[(\d*)\]$/.exec(g),g=g.replace(/\[\d*\]$/,""),!x){v[g]=_;return}v[g]===void 0&&(v[g]={}),v[g][x[1]]=_};case"bracket":return(g,_,v)=>{if(x=/(\[\])$/.exec(g),g=g.replace(/\[\]$/,""),!x){v[g]=_;return}if(v[g]===void 0){v[g]=[_];return}v[g]=[].concat(v[g],_)};case"colon-list-separator":return(g,_,v)=>{if(x=/(:list)$/.exec(g),g=g.replace(/:list$/,""),!x){v[g]=_;return}if(v[g]===void 0){v[g]=[_];return}v[g]=[].concat(v[g],_)};case"comma":case"separator":return(g,_,v)=>{const o=typeof _=="string"&&_.includes(b.arrayFormatSeparator),d=typeof _=="string"&&!o&&w(_,b).includes(b.arrayFormatSeparator);_=d?w(_,b):_;const F=o||d?_.split(b.arrayFormatSeparator).map(K=>w(K,b)):_===null?_:w(_,b);v[g]=F};case"bracket-separator":return(g,_,v)=>{const o=/(\[\])$/.test(g);if(g=g.replace(/\[\]$/,""),!o){v[g]=_&&w(_,b);return}const d=_===null?[]:_.split(b.arrayFormatSeparator).map(F=>w(F,b));if(v[g]===void 0){v[g]=d;return}v[g]=[].concat(v[g],d)};default:return(g,_,v)=>{if(v[g]===void 0){v[g]=_;return}v[g]=[].concat(v[g],_)}}}function h(b){if(typeof b!="string"||b.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function p(b,x){return x.encode?x.strict?e(b):encodeURIComponent(b):b}function w(b,x){return x.decode?r(b):b}function N(b){return Array.isArray(b)?b.sort():typeof b=="object"?N(Object.keys(b)).sort((x,g)=>Number(x)-Number(g)).map(x=>b[x]):b}function m(b){const x=b.indexOf("#");return x!==-1&&(b=b.slice(0,x)),b}function E(b){let x="";const g=b.indexOf("#");return g!==-1&&(x=b.slice(g)),x}function L(b){b=m(b);const x=b.indexOf("?");return x===-1?"":b.slice(x+1)}function C(b,x){return x.parseNumbers&&!Number.isNaN(Number(b))&&typeof b=="string"&&b.trim()!==""?b=Number(b):x.parseBooleans&&b!==null&&(b.toLowerCase()==="true"||b.toLowerCase()==="false")&&(b=b.toLowerCase()==="true"),b}function M(b,x){x=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},x),h(x.arrayFormatSeparator);const g=f(x),_=Object.create(null);if(typeof b!="string"||(b=b.trim().replace(/^[?#&]/,""),!b))return _;for(const v of b.split("&")){if(v==="")continue;let[o,d]=i(x.decode?v.replace(/\+/g," "):v,"=");d=d===void 0?null:["comma","separator","bracket-separator"].includes(x.arrayFormat)?d:w(d,x),g(w(o,x),d,_)}for(const v of Object.keys(_)){const o=_[v];if(typeof o=="object"&&o!==null)for(const d of Object.keys(o))o[d]=C(o[d],x);else _[v]=C(o,x)}return x.sort===!1?_:(x.sort===!0?Object.keys(_).sort():Object.keys(_).sort(x.sort)).reduce((v,o)=>{const d=_[o];return Boolean(d)&&typeof d=="object"&&!Array.isArray(d)?v[o]=N(d):v[o]=d,v},Object.create(null))}t.extract=L,t.parse=M,t.stringify=(b,x)=>{if(!b)return"";x=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},x),h(x.arrayFormatSeparator);const g=d=>x.skipNull&&s(b[d])||x.skipEmptyString&&b[d]==="",_=u(x),v={};for(const d of Object.keys(b))g(d)||(v[d]=b[d]);const o=Object.keys(v);return x.sort!==!1&&o.sort(x.sort),o.map(d=>{const F=b[d];return F===void 0?"":F===null?p(d,x):Array.isArray(F)?F.length===0&&x.arrayFormat==="bracket-separator"?p(d,x)+"[]":F.reduce(_(d),[]).join("&"):p(d,x)+"="+p(F,x)}).filter(d=>d.length>0).join("&")},t.parseUrl=(b,x)=>{x=Object.assign({decode:!0},x);const[g,_]=i(b,"#");return Object.assign({url:g.split("?")[0]||"",query:M(L(b),x)},x&&x.parseFragmentIdentifier&&_?{fragmentIdentifier:w(_,x)}:{})},t.stringifyUrl=(b,x)=>{x=Object.assign({encode:!0,strict:!0,[c]:!0},x);const g=m(b.url).split("?")[0]||"",_=t.extract(b.url),v=t.parse(_,{sort:!1}),o=Object.assign(v,b.query);let d=t.stringify(o,x);d&&(d=`?${d}`);let F=E(b.url);return b.fragmentIdentifier&&(F=`#${x[c]?p(b.fragmentIdentifier,x):b.fragmentIdentifier}`),`${g}${d}${F}`},t.pick=(b,x,g)=>{g=Object.assign({parseFragmentIdentifier:!0,[c]:!1},g);const{url:_,query:v,fragmentIdentifier:o}=t.parseUrl(b,g);return t.stringifyUrl({url:_,query:n(v,x),fragmentIdentifier:o},g)},t.exclude=(b,x,g)=>{const _=Array.isArray(x)?v=>!x.includes(v):(v,o)=>!x(v,o);return t.pick(b,_,g)}})(Dr);const Pl={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},po="base10",lt="base16",tn="base64pad",rn="utf8",go=0,Sr=1,Fl=0,yo=1,nn=12,sn=32;function Ul(){const t=ki.generateKeyPair();return{privateKey:ft(t.secretKey,lt),publicKey:ft(t.publicKey,lt)}}function on(){const t=wr.randomBytes(sn);return ft(t,lt)}function Ml(t,e){const r=ki.sharedKey(ht(t,lt),ht(e,lt)),i=new il(ti.SHA256,r).expand(sn);return ft(i,lt)}function jl(t){const e=ti.hash(ht(t,lt));return ft(e,lt)}function ri(t){const e=ti.hash(ht(t,rn));return ft(e,lt)}function $l(t){return ht(`${t}`,po)}function ii(t){return Number(ft(t,po))}function Bl(t){const e=$l(typeof t.type<"u"?t.type:go);if(ii(e)===Sr&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?ht(t.senderPublicKey,lt):void 0,i=typeof t.iv<"u"?ht(t.iv,lt):wr.randomBytes(nn),n=new Yi.ChaCha20Poly1305(ht(t.symKey,lt)).seal(i,ht(t.message,rn));return Kl({type:e,sealed:n,iv:i,senderPublicKey:r})}function zl(t){const e=new Yi.ChaCha20Poly1305(ht(t.symKey,lt)),{sealed:r,iv:i}=vo(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return ft(n,rn)}function Kl(t){if(ii(t.type)===Sr){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ft(Vi([t.type,t.senderPublicKey,t.iv,t.sealed]),tn)}return ft(Vi([t.type,t.iv,t.sealed]),tn)}function vo(t){const e=ht(t,tn),r=e.slice(Fl,yo),i=yo;if(ii(r)===Sr){const u=i+sn,f=u+nn,h=e.slice(i,u),p=e.slice(u,f),w=e.slice(f);return{type:r,sealed:w,iv:p,senderPublicKey:h}}const n=i+nn,s=e.slice(i,n),c=e.slice(n);return{type:r,sealed:c,iv:s}}function Hl(t,e){const r=vo(t);return _o({type:ii(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ft(r.senderPublicKey,lt):void 0,receiverPublicKey:e?.receiverPublicKey})}function _o(t){const e=t?.type||go;if(e===Sr){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function bo(t){return t.type===Sr&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var Vl=Object.defineProperty,wo=Object.getOwnPropertySymbols,Gl=Object.prototype.hasOwnProperty,ql=Object.prototype.propertyIsEnumerable,mo=(t,e,r)=>e in t?Vl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Eo=(t,e)=>{for(var r in e||(e={}))Gl.call(e,r)&&mo(t,r,e[r]);if(wo)for(var r of wo(e))ql.call(e,r)&&mo(t,r,e[r]);return t};const Wl="ReactNative",xr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Yl="js";function Do(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Xl(){return!oo()&&!!Zi()&&navigator.product===Wl}function Jl(){return!Do()&&!!Zi()}function kl(){return Xl()?xr.reactNative:Do()?xr.node:Jl()?xr.browser:xr.unknown}function Zl(t,e){let r=Dr.parse(t);return r=Eo(Eo({},r),e),t=Dr.stringify(r),t}function Ql(){return co()||{name:"",description:"",url:"",icons:[""]}}function ed(){const t=ll();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function td(){var t;const e=kl();return e===xr.browser?[e,((t=ao())==null?void 0:t.host)||"unknown"].join(":"):e}function rd(t,e,r){const i=ed(),n=td();return[[t,e].join("-"),[Yl,r].join("-"),i,n].join("/")}function id({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s}){const c=r.split("?"),u=rd(t,e,i),f={auth:n,ua:u,projectId:s},h=Zl(c[1]||"",f);return c[0]+"?"+h}function dt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function So(t){return Object.fromEntries(t.entries())}function xo(t){return new Map(Object.entries(t))}function Tt(t,e){return Te.fromMiliseconds((e||Date.now())+Te.toMiliseconds(t))}function Gt(t){return Te.fromMiliseconds(Date.now())>=Te.toMiliseconds(t)}function qt(){const t=Te.toMiliseconds(Te.FIVE_MINUTES);let e,r,i;return{resolve:n=>{i&&e&&(clearTimeout(i),e(n))},reject:n=>{i&&r&&(clearTimeout(i),r(n))},done:()=>new Promise((n,s)=>{i=setTimeout(s,t),e=n,r=s})}}function Oo(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function nd(t){return Oo("topic",t)}function sd(t){return Oo("id",t)}function od(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function je(t,e){return`${t}${e?`:${e}`:""}`}const ad="irn";function an(t){return t?.relay||{protocol:ad}}function cn(t){const e=Pl[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var cd=Object.defineProperty,Io=Object.getOwnPropertySymbols,ud=Object.prototype.hasOwnProperty,fd=Object.prototype.propertyIsEnumerable,Ao=(t,e,r)=>e in t?cd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,hd=(t,e)=>{for(var r in e||(e={}))ud.call(e,r)&&Ao(t,r,e[r]);if(Io)for(var r of Io(e))fd.call(e,r)&&Ao(t,r,e[r]);return t};function ld(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),c=t[n];r[s]=c}}),r}function dd(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",c=Dr.parse(s);return{protocol:i,topic:n[0],version:parseInt(n[1],10),symKey:c.symKey,relay:ld(c)}}function pd(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=r+e+n;t[n]&&(i[s]=t[n])}),i}function gd(t){return`${t.protocol}:${t.topic}@${t.version}?`+Dr.stringify(hd({symKey:t.symKey},pd(t.relay)))}function It(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function yd(t){const e=[];return Object.values(t).forEach(r=>{e.push(...It(r.accounts)),r.extension&&r.extension.forEach(i=>{e.push(...It(i.accounts))})}),e}function vd(t,e){const r=[];return Object.values(t).forEach(i=>{It(i.accounts).includes(e)&&r.push(...i.methods),i.extension&&i.extension.forEach(n=>{It(n.accounts).includes(e)&&r.push(...n.methods)})}),r}function _d(t,e){const r=[];return Object.values(t).forEach(i=>{It(i.accounts).includes(e)&&r.push(...i.events),i.extension&&i.extension.forEach(n=>{It(n.accounts).includes(e)&&r.push(...n.events)})}),r}const bd={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3}},wd={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function V(t,e){const{message:r,code:i}=wd[t];return{message:e?`${r} ${e}`:r,code:i}}function nt(t,e){const{message:r,code:i}=bd[t];return{message:e?`${r} ${e}`:r,code:i}}function Or(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function No(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function yt(t){return typeof t>"u"}function st(t,e){return e&&yt(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function To(t,e){return e&&yt(t)?!0:typeof t=="number"&&!isNaN(t)}function md(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return dt(n,i)?(i.forEach(c=>{const{accounts:u,methods:f,events:h,extension:p}=t.namespaces[c],w=It(u),N=r[c];(!dt(N.chains,w)||!dt(N.methods,f)||!dt(N.events,h))&&(s=!1),s&&p&&p.forEach(m=>{var E;const{accounts:L,methods:C,events:M}=m,b=It(L);(E=N.extension)!=null&&E.find(x=>dt(x.chains,b)&&dt(x.methods,C)&&dt(x.events,M))||(s=!1)})}),s):!1}function un(t){return st(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Ed(t){if(st(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&un(r)}}return!1}function Dd(t){if(st(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Sd(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function xd(t){return t?.topic}function Od(t,e){let r=null;return st(t?.publicKey,!1)||(r=V("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function fn(t,e){let r=null;return yt(t?.extension)||(!Or(t.extension)||!t.extension.length)&&(r=V("MISSING_OR_INVALID",`${e} extension should be an array of namespaces, or omitted`)),r}function Co(t){let e=!0;return Or(t)?t.length&&(e=t.every(r=>st(r,!1))):e=!1,e}function Lo(t,e,r){let i=null;return Or(e)?e.forEach(n=>{i||(!un(n)||!n.includes(t))&&(i=nt("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):i=nt("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),i}function Id(t,e){let r=null;return Object.entries(t).forEach(([i,n])=>{if(r)return;const s=Lo(i,n?.chains,`${e} requiredNamespace`),c=fn(n,e);s?r=s:c?r=c:n.extension&&n.extension.forEach(u=>{if(r)return;const f=Lo(i,u.chains,`${e} extension`);f&&(r=f)})}),r}function Ro(t,e){let r=null;return Or(t)?t.forEach(i=>{r||Ed(i)||(r=nt("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=nt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Ad(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=Ro(i?.accounts,`${e} namespace`),s=fn(i,e);n?r=n:s?r=s:i.extension&&i.extension.forEach(c=>{if(r)return;const u=Ro(c.accounts,`${e} extension`);u&&(r=u)})}),r}function Po(t,e){let r=null;return Co(t?.methods)?Co(t?.events)||(r=nt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=nt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Fo(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=Po(i,`${e}, namespace`),s=fn(i,e);n?r=n:s?r=s:i.extension&&i.extension.forEach(c=>{if(r)return;const u=Po(c,`${e}, extension`);u&&(r=u)})}),r}function Nd(t,e){let r=null;if(t&&No(t)){const i=Fo(t,e);i&&(r=i);const n=Id(t,e);n&&(r=n)}else r=V("MISSING_OR_INVALID",`${e}, requiredNamespaces should be an object with data`);return r}function hn(t,e){let r=null;if(t&&No(t)){const i=Fo(t,e);i&&(r=i);const n=Ad(t,e);n&&(r=n)}else r=V("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Uo(t){return st(t.protocol,!0)}function Td(t,e){let r=!1;return e&&!t?r=!0:t&&Or(t)&&t.length&&t.forEach(i=>{r=Uo(i)}),r}function Cd(t){return typeof t=="number"}function vt(t){return typeof t<"u"&&typeof t!==null}function Ld(t){return!(!t||typeof t!="object"||!t.code||!To(t.code,!1)||!t.message||!st(t.message,!1))}function Rd(t){return!(yt(t)||!st(t.method,!1))}function Pd(t){return!(yt(t)||yt(t.result)&&yt(t.error)||!To(t.id,!1)||!st(t.jsonrpc,!1))}function Fd(t){return!(yt(t)||!st(t.name,!1))}function Mo(t,e){return!(!un(e)||!yd(t).includes(e))}function Ud(t,e,r){return st(r,!1)?vd(t,e).includes(r):!1}function Md(t,e,r){return st(r,!1)?_d(t,e).includes(r):!1}function jo(t,e,r){let i=null;const n=Object.keys(t),s=Object.keys(e);return dt(n,s)?n.forEach(c=>{var u;if(i)return;const f=t[c].chains,h=It(e[c].accounts);dt(f,h)?dt(t[c].methods,e[c].methods)?dt(t[c].events,e[c].events)?t[c].extension&&!e[c].extension?i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${c}`):t[c].extension&&e[c].extension&&((u=t[c].extension)==null||u.forEach(({methods:p,events:w,chains:N})=>{var m;i||(m=e[c].extension)!=null&&m.find(E=>{const L=It(E.accounts);return dt(N,L)&&dt(w,E.events)&&dt(p,E.methods)})||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${c}`))})):i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy requiredNamespaces events for ${c}`):i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy requiredNamespaces methods for ${c}`):i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy requiredNamespaces chains for ${c}`)}):i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces`),i}const jd="PARSE_ERROR",$d="INVALID_REQUEST",Bd="METHOD_NOT_FOUND",zd="INVALID_PARAMS",$o="INTERNAL_ERROR",ln="SERVER_ERROR",Kd=[-32700,-32600,-32601,-32602,-32603],Ir={[jd]:{code:-32700,message:"Parse error"},[$d]:{code:-32600,message:"Invalid Request"},[Bd]:{code:-32601,message:"Method not found"},[zd]:{code:-32602,message:"Invalid params"},[$o]:{code:-32603,message:"Internal error"},[ln]:{code:-32e3,message:"Server error"}},Bo=ln;function Hd(t){return Kd.includes(t)}function zo(t){return Object.keys(Ir).includes(t)?Ir[t]:Ir[Bo]}function Vd(t){const e=Object.values(Ir).find(r=>r.code===t);return e||Ir[Bo]}function Gd(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Ko={},Ft={};Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.isBrowserCryptoAvailable=Ft.getSubtleCrypto=Ft.getBrowerCrypto=void 0;function dn(){return Z?.crypto||Z?.msCrypto||{}}Ft.getBrowerCrypto=dn;function Ho(){const t=dn();return t.subtle||t.webkitSubtle}Ft.getSubtleCrypto=Ho;function qd(){return!!dn()&&!!Ho()}Ft.isBrowserCryptoAvailable=qd;var Ut={};Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.isBrowser=Ut.isNode=Ut.isReactNative=void 0;function Vo(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Ut.isReactNative=Vo;function Go(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Ut.isNode=Go;function Wd(){return!Vo()&&!Go()}Ut.isBrowser=Wd,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,c){c===void 0&&(c=s),Object.defineProperty(i,c,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,c){c===void 0&&(c=s),i[c]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(Ft,t),r(Ut,t)}(Ko);function Yd(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function pn(t,e,r){return{id:r||Yd(),jsonrpc:"2.0",method:t,params:e}}function qo(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Wo(t,e,r){return{id:t,jsonrpc:"2.0",error:Xd(e,r)}}function Xd(t,e){return typeof t>"u"?zo($o):(typeof t=="string"&&(t=Object.assign(Object.assign({},zo(ln)),{message:t})),typeof e<"u"&&(t.data=e),Hd(t.code)&&(t=Vd(t.code)),t)}class Jd{}class kd extends Jd{constructor(){super()}}class Zd extends kd{constructor(e){super()}}const Qd="^wss?:";function ep(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function tp(t,e){const r=ep(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Yo(t){return tp(t,Qd)}function rp(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Xo(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Jo(t){return Xo(t)&&"method"in t}function ko(t){return Xo(t)&&(Ct(t)||mt(t))}function Ct(t){return"result"in t}function mt(t){return"error"in t}class ip extends Zd{constructor(e){super(e),this.events=new Nt.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(pn(e.method,e.params||[]),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{mt(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ko(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}const Zo=10,np=typeof globalThis.WebSocket<"u"?globalThis.WebSocket:require("ws");class sp{constructor(e){if(this.url=e,this.events=new Nt.exports.EventEmitter,this.registering=!1,!Yo(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(typeof this.socket>"u")throw new Error("Connection already closed");this.socket.close(),this.onClose()}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Fi(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!Yo(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=Ko.isReactNative()?void 0:{rejectUnauthorized:!rp(e)},s=new np(e,[],n);s.onopen=()=>{this.onOpen(s),r(s)},s.onerror=c=>{const u=this.parseError(c.error);this.events.emit("register_error",u),this.onClose(),i(u)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=()=>this.onClose(),e.onerror=r=>{const i=this.parseError(r.error);this.events.emit("error",i)},this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?ds(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=Wo(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return Gd(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Zo&&this.events.setMaxListeners(Zo)}}var gn={exports:{}};(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,s=2,c=9007199254740991,u="[object Arguments]",f="[object Array]",h="[object AsyncFunction]",p="[object Boolean]",w="[object Date]",N="[object Error]",m="[object Function]",E="[object GeneratorFunction]",L="[object Map]",C="[object Number]",M="[object Null]",b="[object Object]",x="[object Promise]",g="[object Proxy]",_="[object RegExp]",v="[object Set]",o="[object String]",d="[object Symbol]",F="[object Undefined]",K="[object WeakMap]",X="[object ArrayBuffer]",J="[object DataView]",k="[object Float32Array]",O="[object Float64Array]",T="[object Int8Array]",G="[object Int16Array]",W="[object Int32Array]",P="[object Uint8Array]",U="[object Uint8ClampedArray]",j="[object Uint16Array]",$="[object Uint32Array]",ie=/[\\^$.*+?()[\]{}|]/g,B=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,Y={};Y[k]=Y[O]=Y[T]=Y[G]=Y[W]=Y[P]=Y[U]=Y[j]=Y[$]=!0,Y[u]=Y[f]=Y[X]=Y[p]=Y[J]=Y[w]=Y[N]=Y[m]=Y[L]=Y[C]=Y[b]=Y[_]=Y[v]=Y[o]=Y[K]=!1;var ae=typeof Z=="object"&&Z&&Z.Object===Object&&Z,A=typeof self=="object"&&self&&self.Object===Object&&self,I=ae||A||Function("return this")(),D=e&&!e.nodeType&&e,a=D&&!0&&t&&!t.nodeType&&t,y=a&&a.exports===D,z=y&&ae.process,H=function(){try{return z&&z.binding&&z.binding("util")}catch{}}(),he=H&&H.isTypedArray;function ve(l,S){for(var R=-1,q=l==null?0:l.length,Ce=0,ne=[];++R<q;){var Me=l[R];S(Me,R,l)&&(ne[Ce++]=Me)}return ne}function de(l,S){for(var R=-1,q=S.length,Ce=l.length;++R<q;)l[Ce+R]=S[R];return l}function we(l,S){for(var R=-1,q=l==null?0:l.length;++R<q;)if(S(l[R],R,l))return!0;return!1}function $e(l,S){for(var R=-1,q=Array(l);++R<l;)q[R]=S(R);return q}function Pe(l){return function(S){return l(S)}}function ye(l,S){return l.has(S)}function pe(l,S){return l?.[S]}function le(l){var S=-1,R=Array(l.size);return l.forEach(function(q,Ce){R[++S]=[Ce,q]}),R}function ue(l,S){return function(R){return l(S(R))}}function ce(l){var S=-1,R=Array(l.size);return l.forEach(function(q){R[++S]=q}),R}var oe=Array.prototype,se=Function.prototype,te=Object.prototype,fe=I["__core-js_shared__"],ge=se.toString,re=te.hasOwnProperty,_e=function(){var l=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""}(),be=te.toString,Ee=RegExp("^"+ge.call(re).replace(ie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=y?I.Buffer:void 0,me=I.Symbol,Dt=I.Uint8Array,At=te.propertyIsEnumerable,jt=oe.splice,pt=me?me.toStringTag:void 0,Yt=Object.getOwnPropertySymbols,Lr=De?De.isBuffer:void 0,hi=ue(Object.keys,Object),Be=hr(I,"DataView"),Fe=hr(I,"Map"),ze=hr(I,"Promise"),Ke=hr(I,"Set"),He=hr(I,"WeakMap"),Ue=hr(Object,"create"),qe=Jt(Be),We=Jt(Fe),Ye=Jt(ze),Xe=Jt(Ke),Je=Jt(He),Ge=me?me.prototype:void 0,Ve=Ge?Ge.valueOf:void 0;function Le(l){var S=-1,R=l==null?0:l.length;for(this.clear();++S<R;){var q=l[S];this.set(q[0],q[1])}}function ke(){this.__data__=Ue?Ue(null):{},this.size=0}function Ze(l){var S=this.has(l)&&delete this.__data__[l];return this.size-=S?1:0,S}function V0(l){var S=this.__data__;if(Ue){var R=S[l];return R===i?void 0:R}return re.call(S,l)?S[l]:void 0}function G0(l){var S=this.__data__;return Ue?S[l]!==void 0:re.call(S,l)}function q0(l,S){var R=this.__data__;return this.size+=this.has(l)?0:1,R[l]=Ue&&S===void 0?i:S,this}Le.prototype.clear=ke,Le.prototype.delete=Ze,Le.prototype.get=V0,Le.prototype.has=G0,Le.prototype.set=q0;function Lt(l){var S=-1,R=l==null?0:l.length;for(this.clear();++S<R;){var q=l[S];this.set(q[0],q[1])}}function W0(){this.__data__=[],this.size=0}function Y0(l){var S=this.__data__,R=di(S,l);if(R<0)return!1;var q=S.length-1;return R==q?S.pop():jt.call(S,R,1),--this.size,!0}function X0(l){var S=this.__data__,R=di(S,l);return R<0?void 0:S[R][1]}function J0(l){return di(this.__data__,l)>-1}function k0(l,S){var R=this.__data__,q=di(R,l);return q<0?(++this.size,R.push([l,S])):R[q][1]=S,this}Lt.prototype.clear=W0,Lt.prototype.delete=Y0,Lt.prototype.get=X0,Lt.prototype.has=J0,Lt.prototype.set=k0;function Xt(l){var S=-1,R=l==null?0:l.length;for(this.clear();++S<R;){var q=l[S];this.set(q[0],q[1])}}function Z0(){this.size=0,this.__data__={hash:new Le,map:new(Fe||Lt),string:new Le}}function Q0(l){var S=pi(this,l).delete(l);return this.size-=S?1:0,S}function e1(l){return pi(this,l).get(l)}function t1(l){return pi(this,l).has(l)}function r1(l,S){var R=pi(this,l),q=R.size;return R.set(l,S),this.size+=R.size==q?0:1,this}Xt.prototype.clear=Z0,Xt.prototype.delete=Q0,Xt.prototype.get=e1,Xt.prototype.has=t1,Xt.prototype.set=r1;function li(l){var S=-1,R=l==null?0:l.length;for(this.__data__=new Xt;++S<R;)this.add(l[S])}function i1(l){return this.__data__.set(l,i),this}function n1(l){return this.__data__.has(l)}li.prototype.add=li.prototype.push=i1,li.prototype.has=n1;function $t(l){var S=this.__data__=new Lt(l);this.size=S.size}function s1(){this.__data__=new Lt,this.size=0}function o1(l){var S=this.__data__,R=S.delete(l);return this.size=S.size,R}function a1(l){return this.__data__.get(l)}function c1(l){return this.__data__.has(l)}function u1(l,S){var R=this.__data__;if(R instanceof Lt){var q=R.__data__;if(!Fe||q.length<r-1)return q.push([l,S]),this.size=++R.size,this;R=this.__data__=new Xt(q)}return R.set(l,S),this.size=R.size,this}$t.prototype.clear=s1,$t.prototype.delete=o1,$t.prototype.get=a1,$t.prototype.has=c1,$t.prototype.set=u1;function f1(l,S){var R=gi(l),q=!R&&x1(l),Ce=!R&&!q&&On(l),ne=!R&&!q&&!Ce&&oc(l),Me=R||q||Ce||ne,Qe=Me?$e(l.length,String):[],rt=Qe.length;for(var Re in l)(S||re.call(l,Re))&&!(Me&&(Re=="length"||Ce&&(Re=="offset"||Re=="parent")||ne&&(Re=="buffer"||Re=="byteLength"||Re=="byteOffset")||w1(Re,rt)))&&Qe.push(Re);return Qe}function di(l,S){for(var R=l.length;R--;)if(rc(l[R][0],S))return R;return-1}function h1(l,S,R){var q=S(l);return gi(l)?q:de(q,R(l))}function Rr(l){return l==null?l===void 0?F:M:pt&&pt in Object(l)?_1(l):S1(l)}function Za(l){return Pr(l)&&Rr(l)==u}function Qa(l,S,R,q,Ce){return l===S?!0:l==null||S==null||!Pr(l)&&!Pr(S)?l!==l&&S!==S:l1(l,S,R,q,Qa,Ce)}function l1(l,S,R,q,Ce,ne){var Me=gi(l),Qe=gi(S),rt=Me?f:Bt(l),Re=Qe?f:Bt(S);rt=rt==u?b:rt,Re=Re==u?b:Re;var gt=rt==b,St=Re==b,ot=rt==Re;if(ot&&On(l)){if(!On(S))return!1;Me=!0,gt=!1}if(ot&&!gt)return ne||(ne=new $t),Me||oc(l)?ec(l,S,R,q,Ce,ne):y1(l,S,rt,R,q,Ce,ne);if(!(R&n)){var bt=gt&&re.call(l,"__wrapped__"),wt=St&&re.call(S,"__wrapped__");if(bt||wt){var zt=bt?l.value():l,Rt=wt?S.value():S;return ne||(ne=new $t),Ce(zt,Rt,R,q,ne)}}return ot?(ne||(ne=new $t),v1(l,S,R,q,Ce,ne)):!1}function d1(l){if(!sc(l)||E1(l))return!1;var S=ic(l)?Ee:B;return S.test(Jt(l))}function p1(l){return Pr(l)&&nc(l.length)&&!!Y[Rr(l)]}function g1(l){if(!D1(l))return hi(l);var S=[];for(var R in Object(l))re.call(l,R)&&R!="constructor"&&S.push(R);return S}function ec(l,S,R,q,Ce,ne){var Me=R&n,Qe=l.length,rt=S.length;if(Qe!=rt&&!(Me&&rt>Qe))return!1;var Re=ne.get(l);if(Re&&ne.get(S))return Re==S;var gt=-1,St=!0,ot=R&s?new li:void 0;for(ne.set(l,S),ne.set(S,l);++gt<Qe;){var bt=l[gt],wt=S[gt];if(q)var zt=Me?q(wt,bt,gt,S,l,ne):q(bt,wt,gt,l,S,ne);if(zt!==void 0){if(zt)continue;St=!1;break}if(ot){if(!we(S,function(Rt,kt){if(!ye(ot,kt)&&(bt===Rt||Ce(bt,Rt,R,q,ne)))return ot.push(kt)})){St=!1;break}}else if(!(bt===wt||Ce(bt,wt,R,q,ne))){St=!1;break}}return ne.delete(l),ne.delete(S),St}function y1(l,S,R,q,Ce,ne,Me){switch(R){case J:if(l.byteLength!=S.byteLength||l.byteOffset!=S.byteOffset)return!1;l=l.buffer,S=S.buffer;case X:return!(l.byteLength!=S.byteLength||!ne(new Dt(l),new Dt(S)));case p:case w:case C:return rc(+l,+S);case N:return l.name==S.name&&l.message==S.message;case _:case o:return l==S+"";case L:var Qe=le;case v:var rt=q&n;if(Qe||(Qe=ce),l.size!=S.size&&!rt)return!1;var Re=Me.get(l);if(Re)return Re==S;q|=s,Me.set(l,S);var gt=ec(Qe(l),Qe(S),q,Ce,ne,Me);return Me.delete(l),gt;case d:if(Ve)return Ve.call(l)==Ve.call(S)}return!1}function v1(l,S,R,q,Ce,ne){var Me=R&n,Qe=tc(l),rt=Qe.length,Re=tc(S),gt=Re.length;if(rt!=gt&&!Me)return!1;for(var St=rt;St--;){var ot=Qe[St];if(!(Me?ot in S:re.call(S,ot)))return!1}var bt=ne.get(l);if(bt&&ne.get(S))return bt==S;var wt=!0;ne.set(l,S),ne.set(S,l);for(var zt=Me;++St<rt;){ot=Qe[St];var Rt=l[ot],kt=S[ot];if(q)var ac=Me?q(kt,Rt,ot,S,l,ne):q(Rt,kt,ot,l,S,ne);if(!(ac===void 0?Rt===kt||Ce(Rt,kt,R,q,ne):ac)){wt=!1;break}zt||(zt=ot=="constructor")}if(wt&&!zt){var yi=l.constructor,vi=S.constructor;yi!=vi&&"constructor"in l&&"constructor"in S&&!(typeof yi=="function"&&yi instanceof yi&&typeof vi=="function"&&vi instanceof vi)&&(wt=!1)}return ne.delete(l),ne.delete(S),wt}function tc(l){return h1(l,A1,b1)}function pi(l,S){var R=l.__data__;return m1(S)?R[typeof S=="string"?"string":"hash"]:R.map}function hr(l,S){var R=pe(l,S);return d1(R)?R:void 0}function _1(l){var S=re.call(l,pt),R=l[pt];try{l[pt]=void 0;var q=!0}catch{}var Ce=be.call(l);return q&&(S?l[pt]=R:delete l[pt]),Ce}var b1=Yt?function(l){return l==null?[]:(l=Object(l),ve(Yt(l),function(S){return At.call(l,S)}))}:N1,Bt=Rr;(Be&&Bt(new Be(new ArrayBuffer(1)))!=J||Fe&&Bt(new Fe)!=L||ze&&Bt(ze.resolve())!=x||Ke&&Bt(new Ke)!=v||He&&Bt(new He)!=K)&&(Bt=function(l){var S=Rr(l),R=S==b?l.constructor:void 0,q=R?Jt(R):"";if(q)switch(q){case qe:return J;case We:return L;case Ye:return x;case Xe:return v;case Je:return K}return S});function w1(l,S){return S=S??c,!!S&&(typeof l=="number"||Q.test(l))&&l>-1&&l%1==0&&l<S}function m1(l){var S=typeof l;return S=="string"||S=="number"||S=="symbol"||S=="boolean"?l!=="__proto__":l===null}function E1(l){return!!_e&&_e in l}function D1(l){var S=l&&l.constructor,R=typeof S=="function"&&S.prototype||te;return l===R}function S1(l){return be.call(l)}function Jt(l){if(l!=null){try{return ge.call(l)}catch{}try{return l+""}catch{}}return""}function rc(l,S){return l===S||l!==l&&S!==S}var x1=Za(function(){return arguments}())?Za:function(l){return Pr(l)&&re.call(l,"callee")&&!At.call(l,"callee")},gi=Array.isArray;function O1(l){return l!=null&&nc(l.length)&&!ic(l)}var On=Lr||T1;function I1(l,S){return Qa(l,S)}function ic(l){if(!sc(l))return!1;var S=Rr(l);return S==m||S==E||S==h||S==g}function nc(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=c}function sc(l){var S=typeof l;return l!=null&&(S=="object"||S=="function")}function Pr(l){return l!=null&&typeof l=="object"}var oc=he?Pe(he):p1;function A1(l){return O1(l)?f1(l):g1(l)}function N1(){return[]}function T1(){return!1}t.exports=I1})(gn,gn.exports);var op=gn.exports,ap=Object.defineProperty,Qo=Object.getOwnPropertySymbols,cp=Object.prototype.hasOwnProperty,up=Object.prototype.propertyIsEnumerable,ea=(t,e,r)=>e in t?ap(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ut=(t,e)=>{for(var r in e||(e={}))cp.call(e,r)&&ea(t,r,e[r]);if(Qo)for(var r of Qo(e))up.call(e,r)&&ea(t,r,e[r]);return t},ar={exports:{}},cr=typeof Reflect=="object"?Reflect:null,ta=cr&&typeof cr.apply=="function"?cr.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)},ni;cr&&typeof cr.ownKeys=="function"?ni=cr.ownKeys:Object.getOwnPropertySymbols?ni=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:ni=function(t){return Object.getOwnPropertyNames(t)};function fp(t){console&&console.warn&&console.warn(t)}var ra=Number.isNaN||function(t){return t!==t};function Ie(){Ie.init.call(this)}ar.exports=Ie,ar.exports.once=pp,Ie.EventEmitter=Ie,Ie.prototype._events=void 0,Ie.prototype._eventsCount=0,Ie.prototype._maxListeners=void 0;var ia=10;function si(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ie,"defaultMaxListeners",{enumerable:!0,get:function(){return ia},set:function(t){if(typeof t!="number"||t<0||ra(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ia=t}}),Ie.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ie.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||ra(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function na(t){return t._maxListeners===void 0?Ie.defaultMaxListeners:t._maxListeners}Ie.prototype.getMaxListeners=function(){return na(this)},Ie.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var i=t==="error",n=this._events;if(n!==void 0)i=i&&n.error===void 0;else if(!i)return!1;if(i){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var c=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw c.context=s,c}var u=n[t];if(u===void 0)return!1;if(typeof u=="function")ta(u,this,e);else for(var f=u.length,h=ua(u,f),r=0;r<f;++r)ta(h[r],this,e);return!0};function sa(t,e,r,i){var n,s,c;if(si(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),c=s[e]),c===void 0)c=s[e]=r,++t._eventsCount;else if(typeof c=="function"?c=s[e]=i?[r,c]:[c,r]:i?c.unshift(r):c.push(r),n=na(t),n>0&&c.length>n&&!c.warned){c.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=c.length,fp(u)}return t}Ie.prototype.addListener=function(t,e){return sa(this,t,e,!1)},Ie.prototype.on=Ie.prototype.addListener,Ie.prototype.prependListener=function(t,e){return sa(this,t,e,!0)};function hp(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function oa(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=hp.bind(i);return n.listener=r,i.wrapFn=n,n}Ie.prototype.once=function(t,e){return si(e),this.on(t,oa(this,t,e)),this},Ie.prototype.prependOnceListener=function(t,e){return si(e),this.prependListener(t,oa(this,t,e)),this},Ie.prototype.removeListener=function(t,e){var r,i,n,s,c;if(si(e),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===e||r.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if(typeof r!="function"){for(n=-1,s=r.length-1;s>=0;s--)if(r[s]===e||r[s].listener===e){c=r[s].listener,n=s;break}if(n<0)return this;n===0?r.shift():lp(r,n),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,c||e)}return this},Ie.prototype.off=Ie.prototype.removeListener,Ie.prototype.removeAllListeners=function(t){var e,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var n=Object.keys(r),s;for(i=0;i<n.length;++i)s=n[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=r[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this};function aa(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?dp(n):ua(n,n.length)}Ie.prototype.listeners=function(t){return aa(this,t,!0)},Ie.prototype.rawListeners=function(t){return aa(this,t,!1)},Ie.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):ca.call(t,e)},Ie.prototype.listenerCount=ca;function ca(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Ie.prototype.eventNames=function(){return this._eventsCount>0?ni(this._events):[]};function ua(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function lp(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function dp(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function pp(t,e){return new Promise(function(r,i){function n(c){t.removeListener(e,s),i(c)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}fa(t,e,s,{once:!0}),e!=="error"&&gp(t,n,{once:!0})})}function gp(t,e,r){typeof t.on=="function"&&fa(t,"error",e,r)}function fa(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}function yp(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),c=s.charCodeAt(0);if(r[c]!==255)throw new TypeError(s+" is ambiguous");r[c]=n}var u=t.length,f=t.charAt(0),h=Math.log(u)/Math.log(256),p=Math.log(256)/Math.log(u);function w(E){if(E instanceof Uint8Array||(ArrayBuffer.isView(E)?E=new Uint8Array(E.buffer,E.byteOffset,E.byteLength):Array.isArray(E)&&(E=Uint8Array.from(E))),!(E instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(E.length===0)return"";for(var L=0,C=0,M=0,b=E.length;M!==b&&E[M]===0;)M++,L++;for(var x=(b-M)*p+1>>>0,g=new Uint8Array(x);M!==b;){for(var _=E[M],v=0,o=x-1;(_!==0||v<C)&&o!==-1;o--,v++)_+=256*g[o]>>>0,g[o]=_%u>>>0,_=_/u>>>0;if(_!==0)throw new Error("Non-zero carry");C=v,M++}for(var d=x-C;d!==x&&g[d]===0;)d++;for(var F=f.repeat(L);d<x;++d)F+=t.charAt(g[d]);return F}function N(E){if(typeof E!="string")throw new TypeError("Expected String");if(E.length===0)return new Uint8Array;var L=0;if(E[L]!==" "){for(var C=0,M=0;E[L]===f;)C++,L++;for(var b=(E.length-L)*h+1>>>0,x=new Uint8Array(b);E[L];){var g=r[E.charCodeAt(L)];if(g===255)return;for(var _=0,v=b-1;(g!==0||_<M)&&v!==-1;v--,_++)g+=u*x[v]>>>0,x[v]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");M=_,L++}if(E[L]!==" "){for(var o=b-M;o!==b&&x[o]===0;)o++;for(var d=new Uint8Array(C+(b-o)),F=C;o!==b;)d[F++]=x[o++];return d}}}function m(E){var L=N(E);if(L)return L;throw new Error(`Non-${e} character`)}return{encode:w,decodeUnsafe:N,decode:m}}var vp=yp,_p=vp;const ha=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},bp=t=>new TextEncoder().encode(t),wp=t=>new TextDecoder().decode(t);class mp{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ep{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return la(this,e)}}class Dp{constructor(e){this.decoders=e}or(e){return la(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const la=(t,e)=>new Dp(ut(ut({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class Sp{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new mp(e,r,i),this.decoder=new Ep(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const oi=({name:t,prefix:e,encode:r,decode:i})=>new Sp(t,e,r,i),Ar=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=_p(r,e);return oi({prefix:t,name:e,encode:i,decode:s=>ha(n(s))})},xp=(t,e,r,i)=>{const n={};for(let p=0;p<e.length;++p)n[e[p]]=p;let s=t.length;for(;t[s-1]==="=";)--s;const c=new Uint8Array(s*r/8|0);let u=0,f=0,h=0;for(let p=0;p<s;++p){const w=n[t[p]];if(w===void 0)throw new SyntaxError(`Non-${i} character`);f=f<<r|w,u+=r,u>=8&&(u-=8,c[h++]=255&f>>u)}if(u>=r||255&f<<8-u)throw new SyntaxError("Unexpected end of data");return c},Op=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",c=0,u=0;for(let f=0;f<t.length;++f)for(u=u<<8|t[f],c+=8;c>r;)c-=r,s+=e[n&u>>c];if(c&&(s+=e[n&u<<r-c]),i)for(;s.length*r&7;)s+="=";return s},tt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>oi({prefix:e,name:t,encode(n){return Op(n,i,r)},decode(n){return xp(n,i,r,t)}}),Ip=oi({prefix:"\0",name:"identity",encode:t=>wp(t),decode:t=>bp(t)});var Ap=Object.freeze({__proto__:null,identity:Ip});const Np=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Tp=Object.freeze({__proto__:null,base2:Np});const Cp=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Lp=Object.freeze({__proto__:null,base8:Cp});const Rp=Ar({prefix:"9",name:"base10",alphabet:"0123456789"});var Pp=Object.freeze({__proto__:null,base10:Rp});const Fp=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Up=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Mp=Object.freeze({__proto__:null,base16:Fp,base16upper:Up});const jp=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),$p=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Bp=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),zp=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Kp=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Hp=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Vp=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Gp=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qp=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Wp=Object.freeze({__proto__:null,base32:jp,base32upper:$p,base32pad:Bp,base32padupper:zp,base32hex:Kp,base32hexupper:Hp,base32hexpad:Vp,base32hexpadupper:Gp,base32z:qp});const Yp=Ar({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Xp=Ar({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Jp=Object.freeze({__proto__:null,base36:Yp,base36upper:Xp});const kp=Ar({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Zp=Ar({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Qp=Object.freeze({__proto__:null,base58btc:kp,base58flickr:Zp});const eg=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),tg=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),rg=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ig=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ng=Object.freeze({__proto__:null,base64:eg,base64pad:tg,base64url:rg,base64urlpad:ig});const da=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),sg=da.reduce((t,e,r)=>(t[r]=e,t),[]),og=da.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function ag(t){return t.reduce((e,r)=>(e+=sg[r],e),"")}function cg(t){const e=[];for(const r of t){const i=og[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const ug=oi({prefix:"\u{1F680}",name:"base256emoji",encode:ag,decode:cg});var fg=Object.freeze({__proto__:null,base256emoji:ug}),hg=ga,pa=128,lg=127,dg=~lg,pg=Math.pow(2,31);function ga(t,e,r){e=e||[],r=r||0;for(var i=r;t>=pg;)e[r++]=t&255|pa,t/=128;for(;t&dg;)e[r++]=t&255|pa,t>>>=7;return e[r]=t|0,ga.bytes=r-i+1,e}var gg=yn,yg=128,ya=127;function yn(t,i){var r=0,i=i||0,n=0,s=i,c,u=t.length;do{if(s>=u)throw yn.bytes=0,new RangeError("Could not decode varint");c=t[s++],r+=n<28?(c&ya)<<n:(c&ya)*Math.pow(2,n),n+=7}while(c>=yg);return yn.bytes=s-i,r}var vg=Math.pow(2,7),_g=Math.pow(2,14),bg=Math.pow(2,21),wg=Math.pow(2,28),mg=Math.pow(2,35),Eg=Math.pow(2,42),Dg=Math.pow(2,49),Sg=Math.pow(2,56),xg=Math.pow(2,63),Og=function(t){return t<vg?1:t<_g?2:t<bg?3:t<wg?4:t<mg?5:t<Eg?6:t<Dg?7:t<Sg?8:t<xg?9:10},Ig={encode:hg,decode:gg,encodingLength:Og},va=Ig;const _a=(t,e,r=0)=>(va.encode(t,e,r),e),ba=t=>va.encodingLength(t),vn=(t,e)=>{const r=e.byteLength,i=ba(t),n=i+ba(r),s=new Uint8Array(n+r);return _a(t,s,0),_a(r,s,i),s.set(e,n),new Ag(t,r,e,s)};class Ag{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const wa=({name:t,code:e,encode:r})=>new Ng(t,e,r);class Ng{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?vn(this.code,r):r.then(i=>vn(this.code,i))}else throw Error("Unknown type, must be binary type")}}const ma=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Tg=wa({name:"sha2-256",code:18,encode:ma("SHA-256")}),Cg=wa({name:"sha2-512",code:19,encode:ma("SHA-512")});var Lg=Object.freeze({__proto__:null,sha256:Tg,sha512:Cg});const Ea=0,Rg="identity",Da=ha;var Pg=Object.freeze({__proto__:null,identity:{code:Ea,name:Rg,encode:Da,digest:t=>vn(Ea,Da(t))}});new TextEncoder,new TextDecoder;const Sa=ut(ut(ut(ut(ut(ut(ut(ut(ut(ut({},Ap),Tp),Lp),Pp),Mp),Wp),Jp),Qp),ng),fg);ut(ut({},Lg),Pg);function Fg(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function xa(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Oa=xa("utf8","u",t=>{const e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),_n=xa("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Fg(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ug=ut({utf8:Oa,"utf-8":Oa,hex:Sa.base16,latin1:_n,ascii:_n,binary:_n},Sa);function Mg(t,e="utf8"){const r=Ug[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const Ia="wc",jg=2,bn="core",Nr=`${Ia}@${2}:${bn}:`,$g={name:bn,logger:"error"},Bg={database:":memory:"},zg="crypto",Aa="client_ed25519_seed",Kg=Te.ONE_DAY,Hg="keychain",Vg="0.3",Gg="messages",qg="0.3",Wg=Te.SIX_HOURS,Yg="publisher",Na="irn",Xg="error",Jg="wss://relay.walletconnect.com",kg="relayer",Tr={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error"},Zg="_subscription",ur={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Qg=Te.ONE_SECOND,e0="2.0.0-rc.1",t0="0.3",Wt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync"},r0="subscription",i0="0.3",n0=Te.FIVE_SECONDS*1e3;class s0{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=Hg,this.version=Vg,this.initialized=!1,this.storagePrefix=Nr,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,So(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?xo(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class o0{constructor(e,r,i){this.core=e,this.logger=r,this.name=zg,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),s=Ys(n);return Ws(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=Ul();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const s=await this.getClientSeed(),c=Ys(s),u=on();return await Vh(u,n,Kg,c)},this.generateSharedKey=(n,s,c)=>{this.isInitialized();const u=this.getPrivateKey(n),f=Ml(u,s);return this.setSymKey(f,c)},this.setSymKey=async(n,s)=>{this.isInitialized();const c=s||jl(n);return await this.keychain.set(c,n),c},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,s,c)=>{this.isInitialized();const u=_o(c),f=Fi(s);if(bo(u)){const N=u.senderPublicKey,m=u.receiverPublicKey;n=await this.generateSharedKey(N,m)}const h=this.getSymKey(n),{type:p,senderPublicKey:w}=u;return Bl({type:p,symKey:h,message:f,senderPublicKey:w})},this.decode=async(n,s,c)=>{this.isInitialized();const u=Hl(s,c);if(bo(u)){const p=u.receiverPublicKey,w=u.senderPublicKey;n=await this.generateSharedKey(p,w)}const f=this.getSymKey(n),h=zl({symKey:f,encoded:s});return ds(h)},this.core=e,this.logger=Ae.generateChildLogger(r,this.name),this.keychain=i||new s0(this.core,this.logger)}get context(){return Ae.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Aa)}catch{e=on(),await this.keychain.set(Aa,e)}return Mg(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class a0 extends yu{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=Gg,this.version=qg,this.initialized=!1,this.storagePrefix=Nr,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const s=ri(n);let c=this.messages.get(i);return typeof c>"u"&&(c={}),typeof c[s]<"u"||(c[s]=n,this.messages.set(i,c),await this.persist()),s},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const s=this.get(i),c=ri(n);return typeof s[c]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Ae.generateChildLogger(e,this.name),this.core=r}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,So(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?xo(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class c0 extends vu{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new ar.exports.EventEmitter,this.name=Yg,this.queue=new Map,this.publish=async(i,n,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});try{const c=s?.ttl||Wg,u=an(s),f=s?.prompt||!1,h=s?.tag||0,p={topic:i,message:n,opts:{ttl:c,relay:u,prompt:f,tag:h}},w=ri(n);this.queue.set(w,p),await this.rpcPublish(i,n,c,u,f,h),this.onPublish(w,p),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}})}catch(c){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(c),c}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=Ae.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ae.getLoggerContext(this.logger)}rpcPublish(e,r,i,n,s,c){var u,f,h,p;const w={method:cn(n.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:s,tag:c}};return yt((u=w.params)==null?void 0:u.prompt)&&((f=w.params)==null||delete f.prompt),yt((h=w.params)==null?void 0:h.tag)&&((p=w.params)==null||delete p.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:w}),this.relayer.provider.request(w)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:{ttl:n,relay:s,prompt:c,tag:u}}=e,f=ri(i);await this.rpcPublish(r,i,n,s,c,u),this.onPublish(f,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(_r.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class u0{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var f0=Object.defineProperty,h0=Object.defineProperties,l0=Object.getOwnPropertyDescriptors,Ta=Object.getOwnPropertySymbols,d0=Object.prototype.hasOwnProperty,p0=Object.prototype.propertyIsEnumerable,Ca=(t,e,r)=>e in t?f0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ai=(t,e)=>{for(var r in e||(e={}))d0.call(e,r)&&Ca(t,r,e[r]);if(Ta)for(var r of Ta(e))p0.call(e,r)&&Ca(t,r,e[r]);return t},wn=(t,e)=>h0(t,l0(e));class g0 extends wu{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new u0,this.events=new ar.exports.EventEmitter,this.name=r0,this.version=i0,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=Nr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),await this.reset(),this.registerEventListeners(),this.onEnable())},this.subscribe=async(i,n)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=an(n),c={topic:i,relay:s};this.pending.set(i,c);const u=await this.rpcSubscribe(i,s);return this.onSubscribe(u,c),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),u}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(i,n)=>{this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,s)=>{const c=new Te.Watch;c.start(this.pendingSubscriptionWatchLabel);const u=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(u),c.stop(this.pendingSubscriptionWatchLabel),n(!0)),c.elapsed(this.pendingSubscriptionWatchLabel)>=n0&&(clearInterval(u),c.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pendingSubInterval)}),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=an(i);await this.rpcUnsubscribe(e,r,n);const s=nt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r){const i={method:cn(r.protocol).subscribe,params:{topic:e}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),await this.relayer.provider.request(i)}rpcUnsubscribe(e,r,i){const n={method:cn(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.provider.request(n)}onSubscribe(e,r){this.setSubscription(e,wn(ai({},r),{id:e})),this.pending.delete(r.topic)}onResubscribe(e,r){this.addSubscription(e,wn(ai({},r),{id:e})),this.pending.delete(r.topic)}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,ai({},r)),this.topicMap.set(r.topic,e),this.events.emit(Wt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Wt.deleted,wn(ai({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Wt.sync)}async reset(){!this.cached.length||await Promise.all(this.cached.map(async e=>await this.resubscribe(e)))}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async resubscribe(e){if(!this.ids.includes(e.id)){const{topic:r,relay:i}=e,n={topic:r,relay:i};this.pending.set(n.topic,n);const s=await this.rpcSubscribe(n.topic,n.relay);this.onResubscribe(s,n)}}async onConnect(){await this.reset(),this.onEnable()}onDisconnect(){this.onDisable()}checkPending(){this.pending.forEach(async e=>{const r=await this.rpcSubscribe(e.topic,e.relay);this.onSubscribe(r,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(_r.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.provider.on(ur.connect,async()=>{await this.onConnect()}),this.relayer.provider.on(ur.disconnect,()=>{this.onDisconnect()}),this.events.on(Wt.created,async e=>{const r=Wt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Wt.deleted,async e=>{const r=Wt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var y0=Object.defineProperty,La=Object.getOwnPropertySymbols,v0=Object.prototype.hasOwnProperty,_0=Object.prototype.propertyIsEnumerable,Ra=(t,e,r)=>e in t?y0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,b0=(t,e)=>{for(var r in e||(e={}))v0.call(e,r)&&Ra(t,r,e[r]);if(La)for(var r of La(e))_0.call(e,r)&&Ra(t,r,e[r]);return t};class w0 extends _u{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ar.exports.EventEmitter,this.name=kg,this.initialized=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Ae.generateChildLogger(e.logger,this.name):bi(Ae.getDefaultLoggerOptions({level:e.logger||Xg})),this.messages=new a0(this.logger,e.core),this.subscriber=new g0(this,this.logger),this.publisher=new c0(this,this.logger),this.relayUrl=e?.relayUrl||Jg,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized");const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=this.createProvider(e),await Promise.all([this.messages.init(),this.provider.connect(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Ae.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r})}async subscribe(e,r){return this.isInitialized(),await this.subscriber.subscribe(e,r)}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}createProvider(e){return new ip(new sp(id({sdkVersion:e0,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Jo(e)){if(!e.method.endsWith(Zg))return;const r=e.params,{topic:i,message:n}=r.data,s={topic:i,message:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(b0({type:"event",event:r.id},s)),this.events.emit(r.id,s),await this.acknowledgePayload(e),await this.onMessageEvent(s)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Tr.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=qo(e.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(ur.payload,e=>this.onProviderPayload(e)),this.provider.on(ur.connect,()=>{this.events.emit(Tr.connect)}),this.provider.on(ur.disconnect,()=>{this.events.emit(Tr.disconnect),setTimeout(()=>{this.provider.connect()},Te.toMiliseconds(Qg))}),this.provider.on(ur.error,e=>this.events.emit(Tr.error,e))}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var m0=Object.defineProperty,Pa=Object.getOwnPropertySymbols,E0=Object.prototype.hasOwnProperty,D0=Object.prototype.propertyIsEnumerable,Fa=(t,e,r)=>e in t?m0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ua=(t,e)=>{for(var r in e||(e={}))E0.call(e,r)&&Fa(t,r,e[r]);if(Pa)for(var r of Pa(e))D0.call(e,r)&&Fa(t,r,e[r]);return t};class mn extends bu{constructor(e,r,i,n=Nr,s=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=t0,this.cached=[],this.initialized=!1,this.storagePrefix=Nr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(c=>{Sd(c)?this.map.set(c.id,c):xd(c)?this.map.set(c.topic,c):this.getKey&&c!==null&&!yt(c)&&this.map.set(this.getKey(c),c)}),this.cached=[],this.initialized=!0)},this.set=async(c,u)=>{this.isInitialized(),this.map.has(c)?await this.update(c,u):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:c,value:u}),this.map.set(c,u),await this.persist())},this.get=c=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:c}),this.getData(c)),this.getAll=c=>c?this.values.filter(u=>Object.keys(c).every(f=>op(u[f],c[f]))):this.values,this.update=async(c,u)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:c,update:u});const f=Ua(Ua({},this.getData(c)),u);this.map.set(c,f),await this.persist()},this.delete=async(c,u)=>{this.isInitialized(),this.map.has(c)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:c,reason:u}),this.map.delete(c),await this.persist())},this.logger=Ae.generateChildLogger(r,this.name),this.storagePrefix=n,this.getKey=s}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var S0=Object.defineProperty,Ma=Object.getOwnPropertySymbols,x0=Object.prototype.hasOwnProperty,O0=Object.prototype.propertyIsEnumerable,ja=(t,e,r)=>e in t?S0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$a=(t,e)=>{for(var r in e||(e={}))x0.call(e,r)&&ja(t,r,e[r]);if(Ma)for(var r of Ma(e))O0.call(e,r)&&ja(t,r,e[r]);return t};class En extends pu{constructor(e){super(e),this.protocol=Ia,this.version=jg,this.name=bn,this.events=new ar.exports.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e?.projectId;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:bi(Ae.getDefaultLoggerOptions({level:e?.logger||$g.logger}));this.logger=Ae.generateChildLogger(r,this.name),this.heartbeat=new _r.HeartBeat,this.crypto=new o0(this,this.logger,e?.keychain),this.storage=e!=null&&e.storage?e.storage:new Yc($a($a({},Bg),e?.storageOptions)),this.relayer=new w0({core:this,logger:this.logger,relayUrl:e?.relayUrl,projectId:this.projectId})}static async init(e){const r=new En(e);return await r.initialize(),r}get context(){return Ae.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.relayer.init(),await this.heartbeat.init(),this.initialized=!0,this.logger.info("Core Initilization Success")}catch(e){throw this.logger.info("Core Initilization Failure"),this.logger.error(e.message),e}}}const I0=En,Dn="wc",Sn=2,xn="client",fr=`${Dn}@${Sn}:${xn}:`,ci={name:xn,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},A0={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",pairing_ping:"pairing_ping",session_delete:"session_delete",session_expire:"session_expire",pairing_delete:"pairing_delete",pairing_expire:"pairing_expire",session_request:"session_request",session_event:"session_event",proposal_expire:"proposal_expire"},N0={database:":memory:"},Ba="expirer",_t={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},za="0.3",T0=Te.ONE_DAY,Et={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Ka="history",Ha="0.3",Va="pairing",C0=Te.THIRTY_DAYS,Ga="proposal",qa=Te.THIRTY_DAYS,Wa="session",Cr=Te.SEVEN_DAYS,Ya="engine",ui={wc_pairingDelete:{req:{prompt:!1,tag:1e3},res:{prompt:!1,tag:1001}},wc_pairingPing:{req:{prompt:!1,tag:1002},res:{prompt:!1,tag:1003}},wc_sessionPropose:{req:{prompt:!0,tag:1100},res:{prompt:!1,tag:1101}},wc_sessionSettle:{req:{prompt:!1,tag:1102},res:{prompt:!1,tag:1103}},wc_sessionUpdate:{req:{prompt:!1,tag:1104},res:{prompt:!1,tag:1105}},wc_sessionExtend:{req:{prompt:!1,tag:1106},res:{prompt:!1,tag:1107}},wc_sessionRequest:{req:{prompt:!0,tag:1108},res:{prompt:!1,tag:1109}},wc_sessionEvent:{req:{prompt:!0,tag:1110},res:{prompt:!1,tag:1111}},wc_sessionDelete:{req:{prompt:!1,tag:1112},res:{prompt:!1,tag:1113}},wc_sessionPing:{req:{prompt:!1,tag:1114},res:{prompt:!1,tag:1115}}};var L0=Object.defineProperty,R0=Object.defineProperties,P0=Object.getOwnPropertyDescriptors,Xa=Object.getOwnPropertySymbols,F0=Object.prototype.hasOwnProperty,U0=Object.prototype.propertyIsEnumerable,Ja=(t,e,r)=>e in t?L0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Mt=(t,e)=>{for(var r in e||(e={}))F0.call(e,r)&&Ja(t,r,e[r]);if(Xa)for(var r of Xa(e))U0.call(e,r)&&Ja(t,r,e[r]);return t},ka=(t,e)=>R0(t,P0(e));class M0 extends Au{constructor(e){super(e),this.events=new Nt.exports,this.initialized=!1,this.name=Ya,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0)},this.connect=async r=>{this.isInitialized(),await this.isValidConnect(r);const{pairingTopic:i,requiredNamespaces:n,relays:s}=r;let c=i,u,f=!1;if(c&&(f=this.client.pairing.get(c).active),!c||!f){const{topic:C,uri:M}=await this.createPairing();c=C,u=M}const h=await this.client.core.crypto.generateKeyPair(),p={requiredNamespaces:n,relays:s??[{protocol:Na}],proposer:{publicKey:h,metadata:this.client.metadata}},{reject:w,resolve:N,done:m}=qt();if(this.events.once(je("session_connect"),async({error:C,session:M})=>{if(C)w(C);else if(M){M.self.publicKey=h;const b=ka(Mt({},M),{requiredNamespaces:n});await this.client.session.set(M.topic,b),await this.setExpiry(M.topic,M.expiry),c&&await this.client.pairing.update(c,{peerMetadata:M.peer.metadata}),N(b)}}),!c){const{message:C}=V("NO_MATCHING_KEY",`connect() pairing topic: ${c}`);throw new Error(C)}const E=await this.sendRequest(c,"wc_sessionPropose",p),L=Tt(Te.FIVE_MINUTES);return await this.setProposal(E,Mt({id:E,expiry:L},p)),{uri:u,approval:m}},this.pair=async r=>{this.isInitialized(),this.isValidPair(r);const{topic:i,symKey:n,relay:s}=dd(r.uri),c=Tt(Te.FIVE_MINUTES),u={topic:i,relay:s,expiry:c,active:!1};return await this.client.pairing.set(i,u),await this.client.core.crypto.setSymKey(n,i),await this.client.core.relayer.subscribe(i,{relay:s}),await this.setExpiry(i,c),u},this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:n,namespaces:s}=r,{pairingTopic:c,proposer:u,requiredNamespaces:f}=this.client.proposal.get(i),h=await this.client.core.crypto.generateKeyPair(),p=u.publicKey,w=await this.client.core.crypto.generateSharedKey(h,p),N={relay:{protocol:n??"irn"},namespaces:s,requiredNamespaces:f,controller:{publicKey:h,metadata:this.client.metadata},expiry:Tt(Cr)};await this.client.core.relayer.subscribe(w);const m=await this.sendRequest(w,"wc_sessionSettle",N),{done:E,resolve:L,reject:C}=qt();this.events.once(je("session_approve",m),({error:b})=>{b?C(b):L(this.client.session.get(w))});const M=ka(Mt({},N),{topic:w,acknowledged:!1,self:N.controller,peer:{publicKey:u.publicKey,metadata:u.metadata},controller:h});return await this.client.session.set(w,M),await this.setExpiry(w,Tt(Cr)),c&&await this.client.pairing.update(c,{peerMetadata:M.peer.metadata}),c&&i&&(await this.sendResult(i,c,{relay:{protocol:n??"irn"},responderPublicKey:h}),await this.client.proposal.delete(i,nt("USER_DISCONNECTED")),await this.activatePairing(c)),{topic:w,acknowledged:E}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:i,reason:n}=r,{pairingTopic:s}=this.client.proposal.get(i);s&&(await this.sendError(i,s,n),await this.client.proposal.delete(i,nt("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:n}=r,s=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:n}),{done:c,resolve:u,reject:f}=qt();return this.events.once(je("session_update",s),({error:h})=>{h?f(h):u()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:c}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,n=await this.sendRequest(i,"wc_sessionExtend",{}),{done:s,resolve:c,reject:u}=qt();return this.events.once(je("session_extend",n),({error:f})=>{f?u(f):c()}),await this.setExpiry(i,Tt(Cr)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:n,topic:s}=r,c=await this.sendRequest(s,"wc_sessionRequest",{request:n,chainId:i}),{done:u,resolve:f,reject:h}=qt();return this.events.once(je("session_request",c),({error:p,result:w})=>{p?h(p):f(w)}),await u()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:s}=n;Ct(n)?await this.sendResult(s,i,n.result):mt(n)&&await this.sendError(s,i,n.error)},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=await this.sendRequest(i,"wc_sessionPing",{}),{done:s,resolve:c,reject:u}=qt();this.events.once(je("session_ping",n),({error:f})=>{f?u(f):c()}),await s()}else if(this.client.pairing.keys.includes(i)){const n=await this.sendRequest(i,"wc_pairingPing",{}),{done:s,resolve:c,reject:u}=qt();this.events.once(je("pairing_ping",n),({error:f})=>{f?u(f):c()}),await s()}},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r;await this.sendRequest(i,"wc_sessionEvent",{event:n,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.client.session.keys.includes(i)?(await this.sendRequest(i,"wc_sessionDelete",nt("USER_DISCONNECTED")),await this.deleteSession(i)):this.client.pairing.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",nt("USER_DISCONNECTED")),await this.deletePairing(i))},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>md(i,r))),this.activatePairing=async r=>{const i=Tt(qa);await this.client.pairing.update(r,{active:!0,expiry:i}),await this.setExpiry(r,i)},this.deleteSession=async r=>{const{self:i}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,nt("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(i.publicKey),this.client.core.crypto.deleteSymKey(r),this.client.expirer.del(r)])},this.deletePairing=async r=>{await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.pairing.delete(r,nt("USER_DISCONNECTED")),this.client.core.crypto.deleteSymKey(r),this.client.expirer.del(r)])},this.deleteProposal=async r=>{await Promise.all([this.client.proposal.delete(r,nt("USER_DISCONNECTED")),this.client.expirer.del(r)])},this.setExpiry=async(r,i)=>{this.client.pairing.keys.includes(r)?await this.client.pairing.update(r,{expiry:i}):this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.expirer.set(r,i.expiry)},this.sendRequest=async(r,i,n)=>{const s=pn(i,n),c=await this.client.core.crypto.encode(r,s),u=ui[i].req;return this.client.history.set(r,s),await this.client.core.relayer.publish(r,c,u),s.id},this.sendResult=async(r,i,n)=>{const s=qo(r,n),c=await this.client.core.crypto.encode(i,s),u=await this.client.history.get(i,r),f=ui[u.request.method].res;await this.client.core.relayer.publish(i,c,f),await this.client.history.resolve(s)},this.sendError=async(r,i,n)=>{const s=Wo(r,n),c=await this.client.core.crypto.encode(i,s),u=await this.client.history.get(i,r),f=ui[u.request.method].res;await this.client.core.relayer.publish(i,c,f),await this.client.history.resolve(s)},this.cleanup=async()=>{const r=[],i=[],n=[];this.client.session.getAll().forEach(s=>{Gt(s.expiry)&&r.push(s.topic)}),this.client.pairing.getAll().forEach(s=>{Gt(s.expiry)&&i.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Gt(s.expiry)&&n.push(s.id)}),await Promise.all([...r.map(this.deleteSession),...i.map(this.deletePairing),...n.map(this.deleteProposal)])},this.onRelayEventRequest=r=>{const{topic:i,payload:n}=r,s=n.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_pairingPing":return this.onPairingPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n}=r,s=(await this.client.history.get(i,n.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_pairingPing":return this.onPairingPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onSessionProposeRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidConnect(Mt({},i.params));const c=Tt(Te.FIVE_MINUTES),u=Mt({id:s,pairingTopic:r,expiry:c},n);await this.setProposal(s,u),this.client.events.emit("session_proposal",{id:s,params:u})}catch(c){await this.sendError(s,r,c),this.client.logger.error(c)}},this.onSessionProposeResponse=async(r,i)=>{const{id:n}=i;if(Ct(i)){const{result:s}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const c=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:c});const u=c.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:u});const f=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:f});const h=await this.client.core.crypto.generateSharedKey(u,f);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:h});const p=await this.client.core.relayer.subscribe(h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:p}),await this.activatePairing(r)}else mt(i)&&(await this.client.proposal.delete(n,nt("USER_DISCONNECTED")),this.events.emit(je("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:c,controller:u,expiry:f,namespaces:h}=i.params,p={topic:r,relay:c,expiry:f,namespaces:h,acknowledged:!0,controller:u.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:u.publicKey,metadata:u.metadata}};await this.sendResult(i.id,r,!0),this.events.emit(je("session_connect"),{session:p})}catch(c){await this.sendError(n,r,c),this.client.logger.error(c)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;Ct(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(je("session_approve",n),{})):mt(i)&&(await this.client.session.delete(r,nt("USER_DISCONNECTED")),this.events.emit(je("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidUpdate(Mt({topic:r},n)),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:n})}catch(c){await this.sendError(s,r,c),this.client.logger.error(c)}},this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(je("session_update",n),{}):mt(i)&&this.events.emit(je("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Tt(Cr)),await this.sendResult(n,r,!0),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(je("session_extend",n),{}):mt(i)&&this.events.emit(je("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(je("session_ping",n),{}):mt(i)&&this.events.emit(je("session_ping",n),{error:i.error})},this.onPairingPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.client.events.emit("pairing_ping",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onPairingPingResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(je("pairing_ping",n),{}):mt(i)&&this.events.emit(je("pairing_ping",n),{error:i.error})},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),await this.sendResult(n,r,!0),await this.deleteSession(r),this.client.events.emit("session_delete",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onPairingDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),await this.sendResult(n,r,!0),await this.deletePairing(r),this.client.events.emit("pairing_delete",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidRequest(Mt({topic:r},s)),this.client.events.emit("session_request",{id:n,topic:r,params:s})}catch(c){await this.sendError(n,r,c),this.client.logger.error(c)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(je("session_request",n),{result:i.result}):mt(i)&&this.events.emit(je("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidEmit(Mt({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s})}catch(c){await this.sendError(n,r,c),this.client.logger.error(c)}},this.isValidConnect=async r=>{if(!vt(r)){const{message:u}=V("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(u)}const{pairingTopic:i,requiredNamespaces:n,relays:s}=r;yt(i)||await this.isValidPairingTopic(i);const c=Nd(n,"connect()");if(c)throw new Error(c.message);if(!Td(s,!0)){const{message:u}=V("MISSING_OR_INVALID",`connect() relays: ${s}`);throw new Error(u)}},this.isValidPair=r=>{if(!vt(r)){const{message:i}=V("MISSING_OR_INVALID",`pair() params: ${r}`);throw new Error(i)}if(!Dd(r.uri)){const{message:i}=V("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw new Error(i)}},this.isValidApprove=async r=>{if(!vt(r))throw new Error(V("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s}=r;await this.isValidProposalId(i);const c=this.client.proposal.get(i),u=hn(n,"approve()");if(u)throw new Error(u.message);const f=jo(c.requiredNamespaces,n,"update()");if(f)throw new Error(f.message);if(!st(s,!0)){const{message:h}=V("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(h)}},this.isValidReject=async r=>{if(!vt(r)){const{message:s}=V("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(await this.isValidProposalId(i),!Ld(n)){const{message:s}=V("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!vt(r)){const{message:h}=V("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(h)}const{relay:i,controller:n,namespaces:s,expiry:c}=r;if(!Uo(i)){const{message:h}=V("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(h)}const u=Od(n,"onSessionSettleRequest()");if(u)throw new Error(u.message);const f=hn(s,"onSessionSettleRequest()");if(f)throw new Error(f.message);if(Gt(c)){const{message:h}=V("EXPIRED","onSessionSettleRequest()");throw new Error(h)}},this.isValidUpdate=async r=>{if(!vt(r)){const{message:f}=V("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(f)}const{topic:i,namespaces:n}=r;await this.isValidSessionTopic(i);const s=this.client.session.get(i),c=hn(n,"update()");if(c)throw new Error(c.message);const u=jo(s.requiredNamespaces,n,"update()");if(u)throw new Error(u.message)},this.isValidExtend=async r=>{if(!vt(r)){const{message:n}=V("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!vt(r)){const{message:u}=V("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(u)}const{topic:i,request:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:c}=this.client.session.get(i);if(!Mo(c,s)){const{message:u}=V("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(u)}if(!Rd(n)){const{message:u}=V("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(u)}if(!Ud(c,s,n.method)){const{message:u}=V("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(u)}},this.isValidRespond=async r=>{if(!vt(r)){const{message:s}=V("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:i,response:n}=r;if(await this.isValidSessionTopic(i),!Pd(n)){const{message:s}=V("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!vt(r)){const{message:n}=V("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!vt(r)){const{message:u}=V("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(u)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:c}=this.client.session.get(i);if(!Mo(c,s)){const{message:u}=V("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(u)}if(!Fd(n)){const{message:u}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(u)}if(!Md(c,s,n.name)){const{message:u}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(u)}},this.isValidDisconnect=async r=>{if(!vt(r)){const{message:n}=V("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)}}async createPairing(){const e=on(),r=await this.client.core.crypto.setSymKey(e),i=Tt(Te.FIVE_MINUTES),n={protocol:Na},s={topic:r,expiry:i,relay:n,active:!1},c=gd({protocol:this.client.protocol,version:this.client.version,topic:r,symKey:e,relay:n});return await this.client.pairing.set(r,s),await this.client.core.relayer.subscribe(r),await this.setExpiry(r,i),{topic:r,uri:c}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Tr.message,async e=>{const{topic:r,message:i}=e,n=await this.client.core.crypto.decode(r,i);Jo(n)?(this.client.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):ko(n)&&(await this.client.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.client.expirer.on(_t.expired,async e=>{const{topic:r,id:i}=od(e.target);r?this.client.session.keys.includes(r)?(await this.deleteSession(r),this.client.events.emit("session_expire",{topic:r})):this.client.pairing.keys.includes(r)&&(await this.deletePairing(r),this.client.events.emit("pairing_expire",{topic:r})):i&&await this.deleteProposal(i)})}async isValidPairingTopic(e){if(!st(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.pairing.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Gt(this.client.pairing.get(e).expiry)){await this.deletePairing(e);const{message:r}=V("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!st(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Gt(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=V("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.pairing.keys.includes(e))await this.isValidPairingTopic(e);else if(st(e,!1)){const{message:r}=V("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=V("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!Cd(e)){const{message:r}=V("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Gt(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=V("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class j0 extends Nu{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new Nt.exports.EventEmitter,this.name=Ba,this.version=za,this.cached=[],this.initialized=!1,this.storagePrefix=fr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const s=this.formatTarget(i),c={target:s,expiry:n};this.expirations.set(s,c),this.checkExpiry(s,c),this.events.emit(_t.created,{target:s,expiration:c})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{this.isInitialized();const n=this.formatTarget(i);if(this.has(n)){const s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(_t.deleted,{target:n,expiration:s})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return nd(e);if(typeof e=="number")return sd(e);const{message:r}=V("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(_t.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;Te.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(_t.expired,{target:e,expiration:r})}checkExpirations(){this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(_r.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(_t.created,e=>{const r=_t.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(_t.expired,e=>{const r=_t.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(_t.deleted,e=>{const r=_t.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class $0 extends gu{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new Nt.exports.EventEmitter,this.name=Ka,this.version=Ha,this.cached=[],this.initialized=!1,this.storagePrefix=fr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const c={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s};this.records.set(c.id,c),this.events.emit(Et.created,c)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=mt(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(Et.updated,n))},this.get=async(i,n)=>{this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n});const s=await this.getRecord(n);if(s.topic!==i){const{message:c}=V("MISMATCHED_TOPIC",`${this.name}, ${n}`);throw this.logger.error(c),new Error(c)}return s},this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(Et.deleted,s)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:pn(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Et.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Et.created,e=>{const r=Et.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Et.updated,e=>{const r=Et.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Et.deleted,e=>{const r=Et.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class B0 extends mn{constructor(e,r){super(e,r,Va,fr),this.core=e,this.logger=r}}class z0 extends mn{constructor(e,r){super(e,r,Ga,fr),this.core=e,this.logger=r}}class K0 extends mn{constructor(e,r){super(e,r,Wa,fr),this.core=e,this.logger=r}}class fi extends Iu{constructor(e){super(e),this.protocol=Dn,this.version=Sn,this.name=ci.name,this.events=new Nt.exports.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.name=e?.name||ci.name,this.metadata=e?.metadata||Ql();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:bi(Ae.getDefaultLoggerOptions({level:e?.logger||ci.logger}));this.core=e?.core||new I0(e),this.logger=Ae.generateChildLogger(r,this.name),this.pairing=new B0(this.core,this.logger),this.session=new K0(this.core,this.logger),this.proposal=new z0(this.core,this.logger),this.history=new $0(this.core,this.logger),this.expirer=new j0(this.core,this.logger),this.engine=new M0(this)}static async init(e){const r=new fi(e);return await r.initialize(),r}get context(){return Ae.getLoggerContext(this.logger)}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.pairing.init(),await this.session.init(),await this.proposal.init(),await this.history.init(),await this.expirer.init(),await this.engine.init(),this.logger.info("SignClient Initilization Success")}catch(e){throw this.logger.info("SignClient Initilization Failure"),this.logger.error(e.message),e}}}const H0=fi;Se.ENGINE_CONTEXT=Ya,Se.ENGINE_RPC_OPTS=ui,Se.EXPIRER_CONTEXT=Ba,Se.EXPIRER_DEFAULT_TTL=T0,Se.EXPIRER_EVENTS=_t,Se.EXPIRER_STORAGE_VERSION=za,Se.HISTORY_CONTEXT=Ka,Se.HISTORY_EVENTS=Et,Se.HISTORY_STORAGE_VERSION=Ha,Se.PAIRING_CONTEXT=Va,Se.PAIRING_DEFAULT_TTL=C0,Se.PROPOSAL_CONTEXT=Ga,Se.PROPOSAL_EXPIRY=qa,Se.SESSION_CONTEXT=Wa,Se.SESSION_EXPIRY=Cr,Se.SIGN_CLIENT_CONTEXT=xn,Se.SIGN_CLIENT_DEFAULT=ci,Se.SIGN_CLIENT_EVENTS=A0,Se.SIGN_CLIENT_PROTOCOL=Dn,Se.SIGN_CLIENT_STORAGE_OPTIONS=N0,Se.SIGN_CLIENT_STORAGE_PREFIX=fr,Se.SIGN_CLIENT_VERSION=Sn,Se.SignClient=H0,Se.default=fi,Object.defineProperty(Se,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
